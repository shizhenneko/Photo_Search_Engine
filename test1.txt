(photo) PS C:\Users\86159\Desktop\Photo_Search_Engine> python run_tests.py
运行模式：单元测试（跳过需要API密钥的测试）
提示：使用 --integration 运行完整集成测试
================================================= test session starts =================================================
platform win32 -- Python 3.11.14, pytest-9.0.2, pluggy-1.6.0
rootdir: C:\Users\86159\Desktop\Photo_Search_Engine
plugins: anyio-4.12.1
collected 50 items

tests\test_embedding_service.py .....F                                                                           [ 12%]
tests\test_image_parser.py ........                                                                              [ 28%]
tests\test_indexer.py FFFF.FF                                                                                    [ 42%]
tests\test_searcher.py FFFFFFFFF                                                                                 [ 60%]
tests\test_time_parser.py .....                                                                                  [ 70%]
tests\test_vector_store.py F.......                                                                              [ 86%]
tests\test_vision_llm_service.py ...FF..                                                                         [100%]

====================================================== FAILURES =======================================================
________________________________ EmbeddingServiceTests.test_t5_embedding_service_init _________________________________

self = <tests.test_embedding_service.EmbeddingServiceTests testMethod=test_t5_embedding_service_init>

    def test_t5_embedding_service_init(self) -> None:
        """测试T5 Embedding服务初始化"""
        try:
>           service = T5EmbeddingService(model_name="sentence-t5-base", device="cuda")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

tests\test_embedding_service.py:79:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
Loading weights:   1%|          | 1/99 [00:00<00:00, 1017.05it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   1%|          | 1/99 [00:00<00:00, 1017.05it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1008.25it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1008.25it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1005.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1005.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 997.16it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 799.68it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 833.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 833.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 749.83it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 749.83it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 874.80it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 777.83it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 800.06it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 800.06it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 253.11it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 253.11it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 273.47it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 246.57it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 258.46it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 258.46it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 275.50it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 275.50it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 291.76it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 291.76it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 307.31it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 307.31it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 329.26it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 329.26it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 343.66it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 343.66it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 354.95it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 354.95it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 371.84it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 371.84it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 392.50it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 392.50it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 404.75it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 404.75it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 424.99it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 424.99it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 436.40it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 436.40it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 456.23it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 456.23it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 476.07it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 476.07it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 485.99it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 485.99it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 505.43it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 505.43it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 524.87it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 515.07it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 534.14it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 524.17it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 542.89it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 532.81it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 551.19it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 541.38it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 559.42it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 559.42it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 567.19it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 567.19it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 574.76it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 574.76it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 592.18it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 592.18it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 599.14it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 599.14it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 616.26it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 616.26it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 633.37it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 617.40it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 626.95it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 626.95it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 643.45it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 632.70it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 648.92it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 638.55it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 654.52it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 654.52it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 670.48it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 670.48it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 686.44it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 675.70it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 691.41it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 691.41it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 707.12it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 707.12it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 711.66it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 711.66it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 727.14it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 727.14it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 742.61it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 731.28it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 740.60it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 740.60it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 755.71it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 755.71it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 759.03it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 759.03it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 762.57it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 762.57it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 766.01it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 766.01it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 780.47it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 769.34it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 783.59it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 783.59it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 786.63it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 786.63it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 800.67it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 789.70it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 803.56it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 792.58it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 806.24it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 795.25it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 808.73it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 797.98it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 811.28it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 800.52it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 813.64it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 813.64it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 811.59it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 806.25it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 819.05it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 819.05it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 831.84it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 831.84it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 844.64it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 844.64it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 846.25it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 846.25it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 858.89it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 858.89it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 871.52it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 871.52it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 873.19it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 873.19it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 885.66it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 885.66it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 898.14it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 887.07it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 899.39it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 899.39it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 900.61it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 900.61it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 912.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 901.81it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 913.83it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 913.83it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 914.86it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 914.86it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 915.87it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 915.87it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 916.85it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 916.85it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 928.46it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 917.81it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 929.28it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 929.28it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 930.07it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 924.40it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 935.67it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 928.93it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 940.12it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 940.12it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 940.49it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 940.49it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 941.26it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 933.30it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 938.50it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 938.50it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 939.07it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 939.07it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 949.74it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 949.74it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 960.41it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 960.41it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 971.08it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 960.84it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 971.40it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 971.40it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 981.96it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 981.96it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 992.52it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 992.52it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 992.60it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 992.60it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1003.05it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1003.05it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1013.50it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1002.74it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1013.08it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1013.05it/s, Materializing param=encoder.final_layer_norm.weight]
-------------------------------------------------- Captured log call --------------------------------------------------
WARNING  huggingface_hub.utils._http:_http.py:779 Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
_________________________________ IndexerTests.test_build_index_fails_when_no_photos __________________________________

self = <tests.test_indexer.IndexerTests testMethod=test_build_index_fails_when_no_photos>

    def test_build_index_fails_when_no_photos(self) -> None:
        """测试无照片时构建索引失败"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            data_dir = os.path.join(tmp, "data")
            os.makedirs(photo_dir)
            os.makedirs(data_dir)

            index_path = os.path.join(data_dir, "photo_search.index")
            metadata_path = os.path.join(data_dir, "metadata.json")
            vector_store = VectorStore(768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=data_dir,
                batch_size=5,
            )

tests\test_indexer.py:181:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   3%|▎         | 3/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.q.weigLoading weights:   3%|▎         | 3/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.q.weigLoading weights:   4%|▍         | 4/99 [00:00<00:00, 2018.92it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 2018.92it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1677.32it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1677.32it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 2012.78it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 2012.78it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1751.17it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1400.64it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1145.44it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1145.44it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1057.95it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 943.46it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 1048.29it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 949.02it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 1043.93it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1043.93it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 978.23it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 903.70it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 979.01it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 979.01it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 980.57it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 980.57it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1050.61it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1050.61it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1047.17it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1047.17it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1112.62it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1044.15it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1105.57it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1105.57it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1098.58it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1038.32it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 985.85it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 917.01it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 962.86it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 920.02it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 963.84it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 963.84it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1007.65it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1007.65it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1006.36it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1006.36it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 978.98it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 955.45it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 993.67it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 993.67it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1031.88it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 993.15it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 993.72it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 927.66it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 960.79it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 929.60it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 961.66it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 961.66it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 958.68it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 930.02it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 960.02it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 932.00it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 934.65it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 934.65it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 962.98it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 936.22it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 913.05it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 913.05it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 915.36it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 915.36it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 917.50it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 895.32it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 897.81it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 897.81it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 921.44it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 906.73it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 929.98it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 908.65it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 910.56it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 890.38it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 912.09it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 912.09it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 914.02it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 914.02it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 935.28it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 935.28it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 937.03it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 917.64it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 919.28it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 901.30it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 903.37it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 903.37it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 871.62it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 871.62it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 874.11it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 874.11it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 876.33it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 876.33it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 878.22it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 878.22it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 895.44it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 895.44it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 912.66it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 912.66it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 914.43it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 914.43it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 931.36it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 931.36it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 932.50it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 932.50it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 949.15it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 949.15it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 965.80it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 965.80it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 982.46it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 982.46it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 982.24it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 982.24it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 998.61it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 998.61it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 998.61it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 998.61it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1014.72it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1014.72it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1030.83it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1014.74it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1030.60it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1030.60it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1046.46it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1046.46it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1045.91it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1045.91it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1061.52it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1061.52it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1077.13it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1077.13it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1092.74it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1092.74it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1090.75it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1090.75it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1106.11it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1106.11it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1121.47it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1105.15it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1120.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1120.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1135.43it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1135.43it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1150.57it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1133.41it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1148.32it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1148.32it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1163.24it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1163.24it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1178.15it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1178.15it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1193.06it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1175.54it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1190.23it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1190.23it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1204.93it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1204.93it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1219.62it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1219.62it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1234.31it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1234.31it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1221.99it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1221.99it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1236.36it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1236.36it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1235.22it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1235.22it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1249.42it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1249.42it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1243.63it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1243.63it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1240.26it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1240.26it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1254.04it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1236.75it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1250.34it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1233.73it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1247.14it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1247.14it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1243.95it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1243.95it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1257.19it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1240.40it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1253.46it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1253.46it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1250.33it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1250.33it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1263.22it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1259.89it/s, Materializing param=encoder.final_layer_norm.weight]
______________________________________ IndexerTests.test_compute_fallback_ratio _______________________________________

self = <tests.test_indexer.IndexerTests testMethod=test_compute_fallback_ratio>

    def test_compute_fallback_ratio(self) -> None:
        """测试降级描述占比计算"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            data_dir = os.path.join(tmp, "data")
            os.makedirs(photo_dir)
            os.makedirs(data_dir)

            index_path = os.path.join(data_dir, "index.bin")
            metadata_path = os.path.join(data_dir, "metadata.json")
            vector_store = VectorStore(768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=data_dir,
            )

tests\test_indexer.py:206:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1000.79it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 666.40it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   2%|▏         | 2/99 [00:00<00:00, 666.40it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 749.61it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 749.61it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 799.71it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 666.61it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 833.26it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 714.36it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 857.23it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 857.23it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 778.00it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 699.57it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 710.34it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 651.31it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 677.98it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 630.47it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 700.52it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 700.52it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 727.21it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 703.55it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 680.12it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 643.59it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 697.23it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 661.79it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 667.65it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 667.65it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 663.88it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 649.13it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 615.43it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 592.41it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 629.44it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 629.44it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 642.68it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 642.68it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 678.38it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 643.71it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 655.18it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 634.39it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 666.11it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 645.65it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 656.21it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 656.21it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 666.13it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 666.13it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 658.10it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 658.10it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 667.08it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 667.08it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 675.67it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 675.67it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 683.93it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 683.93it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 675.09it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 675.09it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 682.71it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 682.71it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 690.02it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 690.02it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 713.02it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 696.98it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 719.46it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 719.46it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 710.03it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 710.03it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 660.36it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 660.36it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 666.85it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 654.38it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 673.07it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 660.73it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 666.86it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 666.86it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 672.77it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 672.77it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 690.48it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 690.48it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 695.83it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 695.83it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 713.23it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 706.76it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 723.99it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 723.99it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 741.23it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 741.23it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 758.47it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 745.50it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 762.45it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 762.45it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 779.39it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 766.39it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 783.05it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 770.23it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 773.94it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 773.94it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 783.63it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 783.63it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 774.75it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 774.75it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 778.20it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 778.20it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 781.36it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 781.36it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 784.61it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 784.61it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 787.91it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 787.91it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 790.81it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 790.81it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 793.77it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 793.77it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 807.95it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 796.80it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 810.78it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 798.58it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 812.35it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 812.35it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 826.11it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 826.11it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 839.88it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 839.88it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 841.72it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 841.72it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 855.30it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 855.30it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 868.87it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 868.87it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 882.45it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 882.45it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 885.05it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 885.05it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 898.46it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 886.12it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 899.34it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 885.20it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 889.46it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 889.46it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 902.36it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 890.31it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 889.89it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 889.89it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 892.36it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 892.36it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 897.08it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 897.08it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 909.37it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 909.37it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 921.66it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 921.66it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 933.95it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 922.60it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 934.74it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 934.74it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 946.88it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 946.88it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 947.52it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 947.52it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 959.51it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 948.15it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 960.01it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 948.77it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 960.48it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 960.48it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 957.10it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 948.97it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 960.40it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 949.59it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 960.90it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 954.40it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 965.63it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 965.63it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 976.86it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 976.86it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 980.37it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 980.37it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 991.51it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 986.54it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 997.62it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 997.62it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1008.70it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1008.70it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1019.79it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1006.86it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1017.81it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1017.81it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1017.60it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1006.68it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1011.85it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1011.85it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1022.50it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1011.39it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1021.92it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1011.68it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1016.42it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1005.75it/s, Materializing param=encoder.final_layer_norm.weight]
______________________________ IndexerTests.test_generate_description_with_local_service ______________________________

self = <tests.test_indexer.IndexerTests testMethod=test_generate_description_with_local_service>

    def test_generate_description_with_local_service(self) -> None:
        """测试使用本地Vision服务生成描述"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            os.makedirs(photo_dir)

            img_path = os.path.join(photo_dir, "test.jpg")
            _create_image(img_path, size=(100, 80))

            index_path = os.path.join(tmp, "index.bin")
            metadata_path = os.path.join(tmp, "metadata.json")
            vector_store = VectorStore(dimension=768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=tmp,
            )

tests\test_indexer.py:135:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<00:00, 1000.07it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   1%|          | 1/99 [00:00<00:00, 1000.07it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1000.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 667.25it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 750.46it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 600.19it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 570.32it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 500.13it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 454.63it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 416.22it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 399.72it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 399.72it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 437.25it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 437.25it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 420.53it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 399.76it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 428.44it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 408.60it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 434.37it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 434.37it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 458.01it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 422.90it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 421.60it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 413.64it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 405.83it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 393.68it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 318.76it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 311.68it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 304.13it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 301.03it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 308.62it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 308.62it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 318.52it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 312.48it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 324.96it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 319.15it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 314.55it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 314.55it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 325.80it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 325.80it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 331.87it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 326.65it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 331.96it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 327.03it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 336.87it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 336.87it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 346.45it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 341.51it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 349.82it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 340.28it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 349.14it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 349.14it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 348.59it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 344.11it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 352.33it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 352.33it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 347.34it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 341.84it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 339.43it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 339.43it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 339.22it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 339.22it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 330.58it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 327.18it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 337.40it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 332.29it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 338.91it/s, Materializing param=encoder.embed_tokens.weight]      Loading weights: 100%|██████████| 99/99 [00:00<00:00, 607.28it/s, Materializing param=encoder.final_layer_norm.weight]
________________________________________ IndexerTests.test_get_status_initial _________________________________________

self = <tests.test_indexer.IndexerTests testMethod=test_get_status_initial>

    def test_get_status_initial(self) -> None:
        """测试获取初始状态"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            os.makedirs(photo_dir)

            index_path = os.path.join(tmp, "index.bin")
            metadata_path = os.path.join(tmp, "metadata.json")
            vector_store = VectorStore(dimension=768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=tmp,
            )

tests\test_indexer.py:157:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1001.74it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 997.69it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   2%|▏         | 2/99 [00:00<00:00, 665.45it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 749.79it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 749.79it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 667.14it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 571.68it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 644.03it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 596.07it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 482.61it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 446.94it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 401.84it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 379.99it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 411.73it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 391.80it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 420.21it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 420.21it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 446.04it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 446.04it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 469.67it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 450.49it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 463.80it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 463.80it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 482.36it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 464.80it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 483.29it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 483.29it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 500.40it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 469.31it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 457.60it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 444.86it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 472.66it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 459.93it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 474.14it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 474.14it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 487.57it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 431.93it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 444.66it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 444.66it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 456.75it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 447.04it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 458.56it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 449.03it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 460.08it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 460.08it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 470.81it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 470.81it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 480.82it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 471.92it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 490.79it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 490.79it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 500.22it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 486.45it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 495.32it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 478.38it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 479.19it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 479.19it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 487.67it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 479.81it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 473.05it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 465.95it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 480.98it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 480.98it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 488.72it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 483.07it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 494.04it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 494.04it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 501.22it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 501.22it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 501.20it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 501.20it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 508.06it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 508.06it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 514.48it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 514.48it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 514.34it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 514.34it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 517.17it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 517.17it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 523.07it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 523.07it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 535.83it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 535.83it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 541.87it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 541.87it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 554.47it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 547.44it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 559.88it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 552.19it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 564.46it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 564.46it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 569.69it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 569.69it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 581.81it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 581.81it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 593.93it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 593.93it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 598.74it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 598.74it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 610.72it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 610.72it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 615.34it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 615.34it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 627.17it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 627.17it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 639.01it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 639.01it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 650.84it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 643.26it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 654.95it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 654.95it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 666.65it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 666.65it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 678.34it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 678.34it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 681.95it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 681.95it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 693.50it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 693.50it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 689.15it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 689.15it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 692.62it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 692.62it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 696.05it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 696.05it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 699.24it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 699.24it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 702.63it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 702.63it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 713.44it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 705.83it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 708.96it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 708.96it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 719.54it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 711.99it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 714.95it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 714.95it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 725.31it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 717.95it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 728.21it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 728.21it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 738.46it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 738.46it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 748.72it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 748.72it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 751.22it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 751.22it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 761.37it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 761.37it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 763.76it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 763.76it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 773.81it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 773.81it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 783.86it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 783.86it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 793.91it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 785.87it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 795.81it/s, Materializing param=encoder.embed_tokens.weight]      Loading weights: 100%|██████████| 99/99 [00:00<00:00, 860.60it/s, Materializing param=encoder.final_layer_norm.weight]
____________________________________ IndexerTests.test_scan_photos_empty_directory ____________________________________

self = <tests.test_indexer.IndexerTests testMethod=test_scan_photos_empty_directory>

    def test_scan_photos_empty_directory(self) -> None:
        """测试扫描空目录"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            os.makedirs(photo_dir)

            index_path = os.path.join(tmp, "index.bin")
            metadata_path = os.path.join(tmp, "metadata.json")
            vector_store = VectorStore(dimension=768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=tmp,
            )

tests\test_indexer.py:111:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   3%|▎         | 3/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.q.weigLoading weights:   3%|▎         | 3/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.q.weigLoading weights:   4%|▍         | 4/99 [00:00<00:00, 4047.58it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 4047.58it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 5059.47it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 5059.47it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 6071.37it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 6071.37it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 7083.26it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 3512.40it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 4014.17it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 4014.17it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 4515.94it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 3006.67it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 2504.96it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 2504.96it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 2203.73it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1835.51it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 2002.37it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 2002.37it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1858.80it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1858.80it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1751.75it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1751.75it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1668.29it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1668.29it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1779.51it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1779.51it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1701.54it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1701.54it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1801.63it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1801.63it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1728.56it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1728.56it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1819.54it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1819.54it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1751.34it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1751.34it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1693.49it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1693.49it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1770.46it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1770.46it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1715.43it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1715.43it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1786.91it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1786.91it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1734.34it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1734.34it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1801.05it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1801.05it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1867.75it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1867.75it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1758.26it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1758.26it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  30%|███       | 30/99 [00:00<00:00, 1714.57it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  30%|███       | 30/99 [00:00<00:00, 1714.57it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1771.73it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1771.73it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1730.08it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1730.08it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1784.14it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1784.14it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1743.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1743.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1795.20it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1707.62it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1708.40it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1708.40it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1675.80it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1675.80it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1721.09it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1721.09it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1690.05it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1690.05it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1733.38it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1733.38it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1635.00it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1635.00it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1674.88it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1674.88it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1649.05it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1649.05it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1625.03it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1625.03it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1602.73it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1602.73it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1638.34it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1638.34it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1616.42it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1616.42it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1539.50it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1539.50it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1526.86it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1526.86it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1558.02it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1558.02it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1539.24it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1539.24it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1569.42it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1569.42it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1599.60it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1549.41it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1578.64it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1578.64it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1607.88it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1607.88it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1637.11it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1637.11it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1623.03it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1623.03it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1651.50it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1651.50it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1679.98it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1679.98it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1708.45it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1708.45it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1690.83it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1690.83it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1718.55it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1718.55it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1746.26it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1746.26it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1726.14it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1726.14it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1753.11it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1753.11it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1780.08it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1780.08it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1807.05it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1807.05it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1785.85it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1785.85it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1812.11it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1812.11it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1838.37it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1838.37it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1864.64it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1864.64it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1890.90it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1842.47it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1868.06it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1868.06it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1893.65it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1893.65it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1919.24it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1919.24it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1944.83it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1944.83it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1921.27it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1921.27it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1946.22it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1946.22it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1971.17it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1971.17it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1996.12it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1996.12it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1971.95it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1971.95it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1996.29it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1996.29it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 2020.64it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 2020.64it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 2044.98it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 2044.98it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 2069.33it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 2020.15it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 2043.92it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 2043.92it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 2067.68it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 2067.68it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 2091.45it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 2091.45it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 2115.21it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 2066.09it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 2089.31it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 2089.31it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 2112.52it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 2112.52it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2135.73it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2135.73it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 2158.95it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 2158.95it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2132.67it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2132.67it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 2155.36it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 2155.36it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2178.05it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2178.05it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2200.73it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2200.73it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 2173.95it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 2196.13it/s, Materializing param=encoder.final_layer_norm.weight]
___________________________________ IndexerTests.test_scan_photos_filters_and_sorts ___________________________________

self = <tests.test_indexer.IndexerTests testMethod=test_scan_photos_filters_and_sorts>

    def test_scan_photos_filters_and_sorts(self) -> None:
        """测试扫描照片-过滤和排序"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            os.makedirs(photo_dir)

            img1 = os.path.join(photo_dir, "a.jpg")
            img2 = os.path.join(photo_dir, "b.jpg")
            txt = os.path.join(photo_dir, "readme.txt")
            sub_dir = os.path.join(photo_dir, "sub")
            os.makedirs(sub_dir)
            img3 = os.path.join(sub_dir, "c.jpg")

            _create_image(img1)
            _create_image(img2)
            _create_image(img3)
            with open(txt, "w", encoding="utf-8") as file:
                file.write("x")

            os.utime(img1, (1, 1))
            os.utime(img2, (2, 2))
            os.utime(img3, (3, 3))

            index_path = os.path.join(tmp, "index.bin")
            metadata_path = os.path.join(tmp, "metadata.json")
            vector_store = VectorStore(dimension=768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=tmp,
            )

tests\test_indexer.py:87:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1000.31it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 2000.62it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1000.19it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 999.99it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 999.99it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 999.83it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 999.83it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1000.22it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1000.22it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 999.99it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 999.99it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 875.04it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 875.04it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 888.91it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 888.91it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1000.02it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 900.07it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 952.04it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 952.04it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 1047.24it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 955.76it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1042.65it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 959.34it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 962.32it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 962.32it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 964.95it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 964.95it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1033.88it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1033.88it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1031.68it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1031.68it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1029.74it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1029.74it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1090.31it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1090.31it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1085.17it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1085.17it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1080.57it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1080.57it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1134.60it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1134.60it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1127.74it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1127.74it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1179.00it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1121.47it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1170.23it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1170.23it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1162.35it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1162.35it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1154.98it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1154.98it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1199.40it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1199.40it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1191.04it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1191.04it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1183.23it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1183.23it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  30%|███       | 30/99 [00:00<00:00, 1224.03it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  30%|███       | 30/99 [00:00<00:00, 1176.08it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1215.29it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1215.29it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1254.49it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1207.18it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1244.90it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1244.90it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1282.63it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1282.63it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1320.35it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1320.35it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1308.72it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1308.72it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1345.07it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1345.07it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1381.43it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1381.43it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1417.78it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1368.06it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1403.14it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1403.14it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1438.22it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1438.22it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1473.30it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1473.30it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1508.38it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1457.24it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1491.13it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1491.13it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1525.02it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1525.02it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1558.91it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1558.91it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1540.53it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1540.53it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1573.31it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1573.31it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1606.08it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1606.08it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1638.86it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1638.86it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1671.64it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1618.64it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1650.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1650.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1682.11it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1682.11it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1713.85it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1713.85it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1745.59it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1691.92it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1722.68it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1722.68it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1753.45it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1753.45it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1784.21it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1784.21it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1814.97it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1814.97it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1790.65it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1790.65it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1820.50it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1820.50it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1850.34it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1850.34it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1880.18it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1880.18it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1910.03it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1854.64it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1883.62it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1883.62it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1912.60it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1912.60it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1941.58it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1941.58it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1970.56it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1970.56it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1943.24it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1943.24it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1971.40it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1971.40it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1999.57it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1999.57it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 2027.73it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 2027.73it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1999.57it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1999.57it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 2026.96it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 2026.96it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 2054.35it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 2054.35it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 2081.74it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 2081.74it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 2109.14it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 2109.14it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 2079.58it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 2079.58it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 2106.24it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 2106.24it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 2132.90it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 2132.90it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 2159.57it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 2159.57it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 2129.31it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 2129.31it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 2155.28it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 2155.28it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 2181.25it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 2181.25it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 2207.21it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 2207.21it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 2176.72it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 2176.72it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 2202.03it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 2202.03it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 2227.34it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 2227.34it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 2252.65it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 2252.65it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 2221.74it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 2221.74it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 2246.43it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 2246.43it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2271.11it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2271.11it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 2295.80it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 2295.80it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2320.49it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2264.60it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 2288.69it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 2288.69it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2312.78it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2312.78it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2336.87it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2336.87it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 2360.97it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 2328.93it/s, Materializing param=encoder.final_layer_norm.weight]
________________________________________ SearcherTests.test_distance_to_score _________________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_distance_to_score>

    def test_distance_to_score(self) -> None:
        """测试L2距离转换为相似度分数"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:62:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   3%|▎         | 3/99 [00:00<00:00, 2456.16it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1350.39it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1241.74it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1241.74it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1552.18it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1552.18it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1421.32it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1421.32it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1658.20it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1658.20it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1895.09it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1895.09it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1723.53it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1723.53it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 1915.03it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1721.31it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1741.69it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1741.69it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1638.93it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1638.93it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1561.90it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1386.16it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1236.27it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1236.27it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1193.26it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1117.51it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1192.01it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1142.08it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1171.19it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1171.19it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1159.16it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1088.53it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1108.59it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1075.65it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1132.26it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1070.54it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1067.25it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1067.25it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1064.05it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1014.15it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 971.40it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 971.40it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 972.54it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 972.54it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 972.82it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 972.82it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1011.74it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 974.09it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 975.02it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 941.03it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 943.54it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 943.54it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 915.50it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 915.50it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 917.48it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 890.79it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 893.84it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 893.84it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 896.45it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 872.03it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 853.11it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 853.11it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 878.96it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 856.39it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 881.58it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 881.58it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 906.77it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 906.77it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 931.96it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 909.12it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 933.69it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 933.69it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 958.26it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 958.26it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 982.83it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 959.66it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 983.65it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 983.65it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 984.04it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 984.04it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1007.47it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 983.94it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1006.83it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1006.83it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1006.75it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1006.75it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1029.12it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1006.95it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1028.84it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1028.84it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1027.45it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1027.45it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1026.08it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1026.08it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1047.02it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1047.02it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1033.51it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1033.51it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1053.77it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1032.29it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1052.14it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1052.14it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1047.92it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1047.92it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1067.32it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1050.40it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1069.50it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1069.50it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1066.20it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1056.21it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1074.74it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1074.74it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1093.27it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1093.27it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1091.28it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1091.28it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1109.47it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1109.47it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1107.60it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1107.60it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1125.46it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1125.46it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1143.33it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1143.33it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1140.85it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1140.85it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1158.40it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1158.40it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1175.95it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1175.95it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1193.50it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1193.50it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1190.17it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1190.17it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1207.42it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1207.42it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1224.66it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1224.66it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1220.85it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1220.85it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1237.80it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1237.80it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1254.76it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1254.76it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1271.72it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1250.59it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1267.26it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1267.26it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1262.84it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1262.84it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1279.24it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1258.59it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1274.72it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1274.72it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1270.36it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1270.36it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1286.24it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1266.17it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1281.80it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1281.80it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1277.43it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1277.43it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1273.22it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1273.22it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1288.38it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1288.38it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1283.84it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1283.84it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1298.76it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1298.76it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1294.53it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1294.53it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1309.24it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1309.24it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1323.95it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1304.73it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1319.22it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1319.22it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1314.77it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1314.77it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1329.06it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1329.06it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1343.35it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1343.35it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1338.52it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1338.52it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1352.61it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1352.61it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1366.70it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1366.70it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1380.79it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1375.48it/s, Materializing param=encoder.final_layer_norm.weight]
____________________________________ SearcherTests.test_get_index_stats_not_loaded ____________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_get_index_stats_not_loaded>

    def test_get_index_stats_not_loaded(self) -> None:
        """测试获取索引统计-未加载"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:123:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<00:00, 2025.26it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1009.22it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 753.20it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 753.20it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 802.70it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 667.75it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 625.64it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 625.64it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 600.63it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 500.62it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 500.50it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 500.50it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 500.53it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 471.01it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 529.88it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 500.04it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 526.68it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 500.40it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 550.44it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 550.44it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 571.85it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 571.85it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 619.50it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 591.41it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 636.90it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 636.90it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 682.39it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 652.72it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 696.24it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 667.17it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 680.22it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 680.22it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 720.24it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 720.24it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 730.40it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 730.40it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 768.84it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 753.21it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 790.87it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 790.87it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 798.25it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 798.25it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 834.54it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 834.54it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 870.82it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 870.82it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 875.32it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 875.32it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 910.33it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 910.33it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 945.34it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 945.34it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 946.89it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 946.89it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 980.71it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 948.88it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 981.60it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 981.60it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 970.89it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 970.89it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 986.62it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 986.62it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1001.22it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1001.22it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 998.59it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 998.59it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1027.97it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 998.39it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 998.31it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 998.31it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1008.46it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1008.46it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1035.71it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1035.71it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1034.50it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1034.50it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1061.02it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1061.02it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1059.15it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1059.15it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1084.99it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1084.99it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1110.82it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1110.82it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1136.65it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1094.00it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1118.87it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1118.87it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1143.73it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1143.73it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1168.59it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1140.03it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1164.28it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1164.28it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1188.54it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1188.54it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1212.79it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1212.79it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1207.76it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1207.76it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1202.83it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1202.83it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1198.21it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1198.21it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1220.82it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1193.72it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1215.83it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1215.83it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1211.33it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1211.33it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1232.96it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1206.91it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1228.08it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1228.08it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1249.26it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1249.26it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1244.16it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1244.16it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1238.99it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1225.89it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1245.99it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1245.99it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1240.79it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1240.79it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1260.49it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1260.49it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1280.18it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1255.52it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1274.84it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1274.84it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1294.15it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1294.15it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1313.47it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1313.47it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1307.58it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1307.58it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1326.53it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1326.53it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1345.48it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1345.48it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1339.07it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1339.07it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1357.67it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1357.67it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1376.27it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1376.27it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1394.87it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1369.01it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1387.26it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1362.58it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1380.51it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1380.51it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1373.89it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1373.89it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1391.50it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1367.45it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1384.76it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1384.76it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1402.07it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1378.17it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1395.19it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1395.19it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1388.62it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1388.62it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1405.35it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1405.35it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1398.64it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1398.64it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1415.10it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1392.15it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1408.34it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1408.34it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1424.53it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1401.84it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1417.77it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1395.58it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1411.26it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1411.26it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1404.93it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1404.93it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1420.37it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1398.78it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1413.98it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1413.98it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1407.82it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1407.82it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1412.80it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1412.80it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1427.67it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1427.67it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1431.82it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1431.82it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1438.00it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1442.00it/s, Materializing param=encoder.final_layer_norm.weight]
____________________________________ SearcherTests.test_parse_date_datetime_format ____________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_parse_date_datetime_format>

    def test_parse_date_datetime_format(self) -> None:
        """测试datetime格式日期解析"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:96:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<00:00, 966.76it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   2%|▏         | 2/99 [00:00<00:00, 966.76it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 974.81it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 974.81it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1299.75it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 909.83it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1137.28it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1011.46it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1213.75it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1008.49it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1007.38it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1007.38it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 893.64it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 787.31it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 885.73it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 792.71it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 880.79it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 880.79it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 968.86it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 890.00it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 970.90it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 970.90it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 972.65it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 972.65it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 974.58it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 974.58it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 976.22it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 976.22it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1041.30it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 921.13it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 925.35it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 925.35it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 929.41it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 929.41it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 920.19it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 920.19it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 923.04it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 923.04it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 946.12it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 946.12it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 991.18it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 948.13it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 877.54it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 845.32it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 835.89it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 807.50it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 813.75it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 813.75it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 819.62it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 819.62it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 825.06it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 797.31it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 802.89it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 802.89it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 808.43it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 808.43it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 813.60it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 770.11it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 795.78it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 775.69it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 800.71it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 800.71it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 805.59it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 805.59it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 830.00it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 830.00it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 833.98it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 833.98it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 837.81it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 837.81it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 841.22it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 841.22it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 843.46it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 843.46it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 865.66it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 865.66it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 868.44it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 868.44it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 871.18it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 871.18it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 892.43it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 873.90it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 894.71it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 894.71it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 896.85it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 878.81it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 898.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 898.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 900.80it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 900.80it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 920.38it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 902.76it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 921.96it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 921.96it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 923.49it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 923.49it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 942.33it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 924.88it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 943.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 943.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 944.40it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 944.40it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 962.56it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 941.81it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 959.58it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 959.58it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 977.35it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 977.35it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 973.47it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 973.47it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 990.85it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 990.85it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1008.24it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1008.24it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1025.62it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1007.95it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1015.73it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1015.73it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1032.66it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1032.66it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1049.59it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1049.59it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1048.59it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1048.59it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1065.23it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1065.23it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1064.11it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1064.11it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1080.48it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1063.11it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1079.21it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1079.21it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1077.88it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1077.88it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1093.73it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1076.70it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1092.31it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1092.31it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1090.91it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1090.91it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1106.28it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1089.56it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1104.69it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1104.69it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1103.12it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1103.12it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1118.03it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1118.03it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1105.31it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1105.31it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1119.85it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1111.67it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1126.11it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1126.11it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1140.55it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1140.55it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1143.39it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1143.39it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1157.68it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1157.68it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1171.97it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1171.97it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1186.26it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1169.47it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1183.56it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1183.56it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1197.65it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1197.65it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1211.74it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1211.74it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1208.80it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1208.80it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1222.70it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1222.70it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1236.59it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1219.60it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1233.30it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1233.30it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1230.16it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1230.16it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1243.68it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1226.97it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1240.31it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1240.31it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1253.65it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1237.17it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1250.33it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1250.33it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1247.14it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1247.14it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1260.13it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1243.98it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1256.81it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1253.58it/s, Materializing param=encoder.final_layer_norm.weight]
________________________________________ SearcherTests.test_parse_date_invalid ________________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_parse_date_invalid>

    def test_parse_date_invalid(self) -> None:
        """测试无效日期解析"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:111:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<00:00, 2006.36it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1001.51it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1001.03it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1001.03it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 802.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 668.34it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 625.10it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 555.63it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 599.06it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 544.81it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 570.56it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 521.69it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 568.13it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 532.11it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 598.63it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 561.51it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 587.34it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 555.13it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 578.59it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 549.62it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 533.89it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 510.89it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 520.05it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 520.05it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 527.46it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 517.52it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 534.07it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 534.07it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 532.20it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 483.93it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 498.96it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 484.86it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 485.67it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 472.94it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 474.12it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 474.12it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 475.50it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 475.50it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 476.62it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 476.62it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 467.37it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 457.61it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 468.80it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 459.45it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 460.80it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 452.18it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 453.86it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 445.93it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 463.77it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 463.77it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 457.06it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 449.53it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 451.08it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 451.08it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 459.79it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 452.61it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 447.10it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 447.10it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 448.63it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 442.24it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 443.87it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 443.87it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 451.52it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 451.52it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 465.20it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 458.93it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 472.43it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 472.43it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 473.03it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 473.03it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 479.92it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 479.92it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 486.52it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 474.38it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 477.63it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 471.78it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 473.47it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 473.47it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 479.66it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 474.08it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 480.08it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 480.08it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 485.88it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 480.46it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 486.19it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 480.98it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 491.91it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 486.53it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 492.02it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 486.81it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 487.07it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 487.07it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 487.41it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 487.41it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 485.29it/s, Materializing param=encoder.embed_tokens.weight]      Loading weights: 100%|██████████| 99/99 [00:00<00:00, 732.71it/s, Materializing param=encoder.final_layer_norm.weight]
______________________________________ SearcherTests.test_parse_date_iso_format _______________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_parse_date_iso_format>

    def test_parse_date_iso_format(self) -> None:
        """测试ISO格式日期解析"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:81:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1977.05it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1977.05it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1489.63it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 995.09it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1326.79it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1326.79it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1242.24it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1100.35it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1188.36it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1188.36it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1156.00it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1156.00it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 993.15it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 883.50it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 895.07it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 895.07it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 750.58it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 750.58it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 825.64it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 768.01it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 837.83it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 837.83it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 812.28it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 812.28it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 847.99it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 847.99it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 876.28it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 876.28it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 882.73it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 835.25it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 887.45it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 844.81it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 894.51it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 894.51it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 898.61it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 898.61it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 945.91it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 903.34it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 907.66it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 907.66it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 911.81it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 875.61it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 915.41it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 879.72it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 900.27it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 900.27it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 903.14it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 903.14it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 903.27it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 903.27it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 906.30it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 887.21it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 894.76it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 894.76it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 912.04it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 912.04it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 914.58it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 886.95it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 916.52it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 916.52it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 893.79it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 893.79it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 921.72it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 921.72it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 914.69it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 901.93it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 928.45it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 928.45it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 929.47it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 929.47it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 931.61it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 908.82it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 904.61it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 883.46it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 893.38it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 893.38it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 895.60it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 895.60it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 897.93it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 897.93it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 919.83it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 919.83it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 921.57it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 921.57it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 943.00it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 943.00it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 964.43it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 964.43it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 965.16it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 965.16it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 986.14it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 986.14it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1007.13it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1007.13it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1006.91it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1006.91it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1027.46it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1027.46it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1048.01it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1048.01it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1068.55it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1047.08it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1067.21it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1059.51it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1079.50it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1079.50it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1099.49it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1088.54it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1108.33it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1108.33it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1128.12it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1128.12it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1147.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1147.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1167.70it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1144.30it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1163.70it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1163.70it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1160.77it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1160.77it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1179.79it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1179.79it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1176.86it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1176.86it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1180.76it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1180.76it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1177.32it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1177.32it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1195.43it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1195.43it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1213.55it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1192.00it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1209.79it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1209.79it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1227.58it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1227.58it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1245.37it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1245.37it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1241.07it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1241.07it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1258.55it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1258.55it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1276.03it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1276.03it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1271.30it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1271.30it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1288.48it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1288.48it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1305.66it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1305.66it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1322.84it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1322.84it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1340.02it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1316.76it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1333.64it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1317.08it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1333.75it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1333.75it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1328.19it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1328.19it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1344.59it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1322.50it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1338.63it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1338.63it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1333.22it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1333.22it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1349.09it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1349.09it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1344.01it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1344.01it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1338.72it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1338.72it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1354.11it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1333.56it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1348.71it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1348.71it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1363.86it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1342.30it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1357.21it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1357.21it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1350.87it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1350.87it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1365.56it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1365.56it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1362.25it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1362.25it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1376.74it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1356.96it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1371.25it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1371.25it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1366.05it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1366.05it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1380.14it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1356.37it/s, Materializing param=encoder.final_layer_norm.weight]
___________________________________ SearcherTests.test_search_without_loaded_index ____________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_search_without_loaded_index>

    def test_search_without_loaded_index(self) -> None:
        """测试未加载索引时搜索"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:137:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1405.13it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1405.13it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 2107.69it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 2107.69it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1419.03it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1419.03it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1306.15it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1306.15it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1567.38it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1242.51it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1201.02it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1201.02it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1372.59it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1372.59it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1148.84it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1148.84it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 1131.79it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1131.79it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1244.97it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1118.94it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1107.77it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1107.77it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1099.00it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1013.34it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1012.44it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 943.59it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1010.98it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1010.98it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1078.38it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1078.38it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1048.99it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1048.99it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1110.70it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1110.70it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1103.90it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1103.90it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1040.85it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1040.85it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 989.70it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 944.87it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 908.48it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 872.52it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 877.09it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 844.79it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 850.25it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 850.25it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 826.74it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 826.74it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 859.81it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 859.81it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 892.88it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 852.24it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 883.81it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 883.81it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 887.07it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 887.07it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 917.66it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 890.46it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 920.14it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 920.14it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 922.33it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 896.52it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 924.54it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 924.54it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 952.56it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 926.58it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 928.55it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 928.55it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 930.44it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 930.44it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 932.15it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 932.15it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 957.34it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 933.91it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 935.41it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 913.44it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 915.42it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 904.90it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 906.75it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 906.75it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 908.82it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 908.82it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 910.72it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 910.72it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 931.90it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 912.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 933.37it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 914.39it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 906.98it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 906.98it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 908.47it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 908.47it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 910.21it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 910.21it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 929.17it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 911.91it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 930.52it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 930.52it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 949.13it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 949.13it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 949.90it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 932.85it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 950.79it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 934.12it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 951.74it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 935.29it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 952.61it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 936.41it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 953.44it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 953.44it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 954.21it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 954.21it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 970.95it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 970.95it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 971.43it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 971.43it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 968.21it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 968.21it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 984.34it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 984.34it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1000.48it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1000.48it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1016.62it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1016.62it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1009.75it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1009.75it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1025.53it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1017.41it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1033.06it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1033.06it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1048.72it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1048.72it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1064.37it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1047.85it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1063.26it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1063.26it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1078.67it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1078.67it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1094.08it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1094.08it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1109.49it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1092.62it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1107.80it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1107.80it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1122.97it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1122.97it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1138.15it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1138.15it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1136.07it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1136.07it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1151.02it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1151.02it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1165.97it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1148.79it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1146.49it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1146.49it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1161.00it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1144.51it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1158.81it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1158.81it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1156.60it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1156.60it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1170.71it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1170.71it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1168.34it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1168.34it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1166.04it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1166.04it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1163.76it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1163.76it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1161.47it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1161.47it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1151.60it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1151.60it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1149.46it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1149.46it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1162.38it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1162.38it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1175.29it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1175.29it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1188.21it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1173.09it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1185.84it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1185.84it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1198.59it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1198.59it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1211.35it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1211.35it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1208.58it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1208.58it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1221.17it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1221.17it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1213.90it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1194.93it/s, Materializing param=encoder.final_layer_norm.weight]
___________________________________ SearcherTests.test_validate_query_invalid_chars ___________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_validate_query_invalid_chars>

    def test_validate_query_invalid_chars(self) -> None:
        """测试查询验证-非法字符"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:40:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   3%|▎         | 3/99 [00:00<00:00, 2995.22it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 2995.22it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 3993.62it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 3993.62it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 4992.03it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 4992.03it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 5990.44it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 5990.44it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 6988.84it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 6988.84it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 2514.01it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 2514.01it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 2149.09it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 2149.09it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 1924.52it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1752.23it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1927.45it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1927.45it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1787.60it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1787.60it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1685.45it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1582.16it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1601.58it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1601.58it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1715.98it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1715.98it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1641.53it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1641.53it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1582.16it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1582.16it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1675.23it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1532.48it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1490.65it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1381.98it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1356.41it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1311.64it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1377.22it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1377.22it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1353.80it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1353.80it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1415.33it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1415.33it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1391.15it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1391.15it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1449.11it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1369.45it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1424.23it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1424.23it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1417.35it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1376.65it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1237.54it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1237.54it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1252.12it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1252.12it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  30%|███       | 30/99 [00:00<00:00, 1295.30it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  30%|███       | 30/99 [00:00<00:00, 1295.30it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1282.84it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1282.84it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1324.22it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1324.22it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1311.34it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1311.34it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1351.08it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1299.46it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1237.32it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1237.32it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1272.67it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1272.67it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1268.65it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1268.65it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1259.75it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1259.75it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1292.90it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1292.90it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1326.05it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1326.05it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1315.61it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1315.61it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1347.70it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1347.70it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1379.79it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1379.79it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1411.88it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1411.88it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1399.09it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1399.09it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1430.18it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1430.18it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1461.27it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1461.27it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1492.36it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1492.36it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1477.50it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1477.50it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1507.66it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1507.66it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1514.88it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1514.88it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1544.58it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1544.58it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1574.28it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1574.28it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1603.99it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1603.99it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1633.69it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1586.42it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1615.27it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1615.27it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1644.11it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1644.11it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1672.96it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1672.96it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1654.08it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1654.08it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1682.12it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1682.12it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1710.15it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1710.15it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1738.19it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1738.19it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1718.06it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1718.06it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1745.33it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1745.33it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1772.60it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1772.60it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1799.87it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1799.87it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1778.64it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1778.64it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1805.19it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1805.19it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1831.74it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1831.74it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1858.28it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1858.28it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1836.09it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1836.09it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1861.95it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1861.95it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1887.81it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1887.81it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1913.67it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1913.67it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1939.53it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1890.63it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1915.84it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1915.84it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1941.05it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1941.05it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1966.26it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1966.26it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1991.47it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1942.51it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1967.10it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1967.10it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1991.69it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1991.69it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 2016.28it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 2016.28it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 2040.87it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 2040.87it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 2015.88it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 2015.88it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 2039.88it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 2039.88it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 2063.88it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 2063.88it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 2087.88it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 2087.88it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 2062.36it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 2062.36it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 2085.80it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 2085.80it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 2109.23it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 2109.23it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 2132.67it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 2132.67it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2106.75it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2106.75it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 2129.65it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 2129.65it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2128.05it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2128.05it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 2150.69it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 2150.69it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2173.33it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2173.33it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2195.97it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2195.97it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 2169.33it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 2191.46it/s, Materializing param=encoder.final_layer_norm.weight]
_______________________________________ SearcherTests.test_validate_query_short _______________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_validate_query_short>

    def test_validate_query_short(self) -> None:
        """测试查询验证-过短"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:29:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1013.12it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 2026.23it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 2026.23it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1511.64it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1511.64it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1332.58it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1332.58it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1250.02it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1000.07it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1200.09it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 999.99it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 874.83it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 874.83it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 890.39it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 890.39it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 901.42it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 901.42it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 910.28it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 910.28it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 915.88it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 847.01it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 924.01it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 857.34it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 866.37it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 866.37it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 823.30it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 823.30it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 882.11it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 833.20it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 888.74it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 888.74it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 895.43it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 895.43it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 948.10it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 948.10it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 949.80it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 904.75it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 908.99it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 908.99it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 913.02it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 874.70it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 880.51it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 880.51it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 885.14it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 885.14it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 889.39it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 889.39it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 926.44it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 893.27it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 929.00it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 929.00it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 964.73it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 930.99it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 965.48it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 965.48it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 966.67it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 935.91it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 937.94it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 937.94it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 939.01it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 939.01it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 940.95it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 940.95it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 970.36it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 942.77it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 971.34it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 971.34it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 972.22it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 921.06it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 947.38it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 900.34it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 902.39it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 902.39it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 926.78it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 904.76it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 907.29it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 907.29it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 909.40it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 909.40it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 911.39it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 891.24it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 874.79it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 874.79it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 860.21it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 860.21it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 863.01it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 863.01it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 865.36it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 865.36it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 884.59it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 884.59it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 886.76it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 886.76it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 905.62it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 905.62it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 907.31it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 907.31it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 925.83it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 925.83it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 944.35it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 944.35it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 945.70it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 945.70it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 963.89it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 946.69it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 964.55it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 964.55it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 964.67it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 964.67it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 982.21it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 982.21it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 980.76it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 980.76it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 983.00it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 983.00it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 983.30it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 983.30it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 999.97it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 983.85it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1000.25it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1000.25it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 999.96it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 999.96it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1016.09it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1016.09it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1015.34it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1015.34it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1031.21it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1031.21it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1030.27it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1030.27it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1045.88it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1045.88it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1061.49it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1061.49it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1077.10it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1061.56it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1076.95it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1076.95it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1092.33it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1092.33it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1107.72it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1107.72it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1106.01it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1106.01it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1121.16it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1121.16it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1136.31it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1136.31it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1151.47it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1134.32it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1149.25it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1132.35it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1147.05it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1147.05it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1144.94it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1144.94it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1159.43it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1142.82it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1157.11it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1157.11it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1171.39it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1154.92it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1169.01it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1169.01it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1166.67it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1166.67it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1180.56it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1180.56it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1178.04it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1178.04it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1175.90it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1175.90it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1189.42it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1189.42it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1202.93it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1202.93it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1200.24it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1200.24it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1213.58it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1213.58it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1226.92it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1226.92it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1240.25it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1240.25it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1236.67it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1236.67it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1249.83it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1249.83it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1246.60it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1246.60it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1259.59it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1259.59it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1256.32it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1253.31it/s, Materializing param=encoder.final_layer_norm.weight]
_______________________________________ SearcherTests.test_validate_query_valid _______________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_validate_query_valid>

    def test_validate_query_valid(self) -> None:
        """测试查询验证-有效查询"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:51:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1984.06it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 3968.12it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 3968.12it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 5952.18it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1987.51it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1962.71it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1562.85it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1622.93it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1622.93it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1947.52it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1947.52it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 2272.10it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1713.56it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1958.35it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1573.40it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1478.78it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1478.78it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 1643.09it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1229.50it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1352.45it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1203.69it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1313.11it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1313.11it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1290.13it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1290.13it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1323.27it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1208.46it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1192.04it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1192.04it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1197.71it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1197.71it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1272.57it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1183.61it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1253.24it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1253.24it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1236.72it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1236.72it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1222.22it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1222.22it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1209.28it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1209.28it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1198.08it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1157.01it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1178.28it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1178.28it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1229.51it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1229.51it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1217.93it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1217.93it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1207.77it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1186.65it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1204.62it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1204.62it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1195.55it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1123.38it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1137.65it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1137.65it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  30%|███       | 30/99 [00:00<00:00, 1153.54it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  30%|███       | 30/99 [00:00<00:00, 1153.54it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1147.58it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1147.58it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1142.40it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1142.40it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1137.49it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1137.49it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1132.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1132.91it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1128.54it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1128.54it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1090.45it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1090.45it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1103.74it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1077.07it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1090.15it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1069.35it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1064.09it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1064.09it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1091.37it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1062.21it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1088.76it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1088.76it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1115.32it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1115.32it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1112.36it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1112.36it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1138.22it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1138.22it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1164.09it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1164.09it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1160.00it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1160.00it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1185.22it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1185.22it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1210.43it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1210.43it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1235.65it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1235.65it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1229.87it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1229.87it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1254.47it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1254.47it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1279.07it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1279.07it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1303.66it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1272.36it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1296.37it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1296.37it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1320.38it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1320.38it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1344.38it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1344.38it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1336.29it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1336.29it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1359.73it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1359.73it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1383.18it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1383.18it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1374.35it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1374.35it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1397.25it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1397.25it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1420.16it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1420.16it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1443.07it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1410.71it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1433.10it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1433.10it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1455.49it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1455.49it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1477.88it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1477.88it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1467.48it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1467.48it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1489.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1489.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1511.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1511.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1533.19it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1533.19it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1521.81it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1521.81it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1543.24it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1543.24it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1564.68it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1564.68it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1586.11it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1552.81it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1573.79it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1573.79it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1594.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1594.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1615.76it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1582.44it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1602.99it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1602.99it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1623.54it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1623.54it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1644.09it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1644.09it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1631.12it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1631.12it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1651.25it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1651.25it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1671.39it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1671.39it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1691.53it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1691.53it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1677.89it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1677.89it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1697.63it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1697.63it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1717.37it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1717.37it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1737.11it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1737.11it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1722.84it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1722.84it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1742.20it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1742.20it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1761.56it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1761.56it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1780.91it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1747.10it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1766.09it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1766.09it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1785.08it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1785.08it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1804.08it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1804.08it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1823.07it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1789.09it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1807.73it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1807.73it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1826.37it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1811.24it/s, Materializing param=encoder.final_layer_norm.weight]
______________________________________ VectorStoreTests.test_add_and_search_item ______________________________________

self = <tests.test_vector_store.VectorStoreTests testMethod=test_add_and_search_item>

    def test_add_and_search_item(self) -> None:
        """测试添加和搜索向量"""
        with tempfile.TemporaryDirectory() as tmp:
            index_path = os.path.join(tmp, "index.bin")
            metadata_path = os.path.join(tmp, "metadata.json")
            store = VectorStore(dimension=self.dimension, index_path=index_path, metadata_path=metadata_path)

            vec1 = [0.1] * self.dimension
            vec2 = [0.5] * self.dimension
            store.add_item(vec1, {"id": 1, "photo": "test1.jpg"})
            store.add_item(vec2, {"id": 2, "photo": "test2.jpg"})

            results = store.search(vec1, top_k=1)
            self.assertEqual(len(results), 1)
            self.assertEqual(results[0]["metadata"]["id"], 1)
>           self.assertGreater(results[0]["metadata"], 0.0)
E           TypeError: '>' not supported between instances of 'dict' and 'float'

tests\test_vector_store.py:50: TypeError
_______________________ VisionServiceTests.test_openrouter_vision_service_generate_description ________________________

self = <utils.vision_llm_service.OpenRouterVisionLLMService object at 0x00000210FFEDF3D0>
image_path = 'C:\\Users\\86159\\AppData\\Local\\Temp\\tmpkpnj5ei5\\test.jpg'

    def generate_description(self, image_path: str) -> str:
        """
        生成图片描述（中文）。

        Args:
            image_path (str): 图片路径

        Returns:
            str: 描述文本
        """
        prompt = (
            "请用中文描述这张图片，包含以下要素：\n"
            "1. 场景描述（室内/室外，具体地点）\n"
            "2. 主要主体（人物、物体、动物等）\n"
            "3. 动作或状态（在做什么）\n"
            "4. 环境细节（光线、天气、背景）\n"
            "5. 情绪氛围（欢乐、温馨、宁静等）\n\n"
            "描述长度：50-200字"
        )
        image_url = self._get_image_url(image_path)
        messages = [
            {
                "role": "user",
                "content": [
                    {"type": "text", "text": prompt},
                    {"type": "image_url", "image_url": {"url": image_url}},
                ],
            }
        ]

        for attempt in range(self.max_retries):
            try:
>               response = self.client.chat.completions.create(
                    model=self.model_name,
                    messages=messages,
                    temperature=0.2,
                    timeout=self.timeout,
                )

utils\vision_llm_service.py:128:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\software\anaconda\envs\photo\Lib\site-packages\openai\_utils\_utils.py:286: in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\openai\resources\chat\completions\completions.py:1192: in create
    return self._post(
D:\software\anaconda\envs\photo\Lib\site-packages\openai\_base_client.py:1294: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <openai.OpenAI object at 0x00000210FFEDC7D0>
cast_to = <class 'openai.types.chat.chat_completion.ChatCompletion'>
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...CAppData%5CLocal%5CTemp%5Ctmpkpnj5ei5%5Ctest.jpg'}}]}], 'model': 'openai/gpt-4o', 'temperature': 0.2}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -> ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)

        # create a copy of the options we were given so that if the
        # options are mutated later & we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()

        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)

        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)

            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)

            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth

            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects

            log.debug("Sending HTTP Request: %s %s", request.method, request.url)

            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)

                if remaining_retries > 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue

                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)

                if remaining_retries > 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue

                log.debug("Raising connection error")
                raise APIConnectionError(request=request) from err

            log.debug(
                'HTTP Response: %s %s "%i %s" %s',
                request.method,
                request.url,
                response.status_code,
                response.reason_phrase,
                response.headers,
            )
            log.debug("request_id: %s", response.headers.get("x-request-id"))

            try:
                response.raise_for_status()
            except httpx.HTTPStatusError as err:  # thrown on 4xx and 5xx status code
                log.debug("Encountered httpx.HTTPStatusError", exc_info=True)

                if remaining_retries > 0 and self._should_retry(err.response):
                    err.response.close()
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=response,
                    )
                    continue

                # If the response is streamed then we need to explicitly read the response
                # to completion before attempting to access the response text.
                if not err.response.is_closed:
                    err.response.read()

                log.debug("Re-raising status error")
>               raise self._make_status_error_from_response(err.response) from None
E               openai.BadRequestError: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata': {'raw': '{"error":{"code":"BadRequest","message":"The provided image url is not accessible.","param":null,"type":null}}', 'provider_name': 'Azure', 'is_byok': False}}, 'user_id': 'user_30twuG2y5I55gCwfq74EVMLScN9'}

D:\software\anaconda\envs\photo\Lib\site-packages\openai\_base_client.py:1067: BadRequestError

The above exception was the direct cause of the following exception:

self = <tests.test_vision_llm_service.VisionServiceTests testMethod=test_openrouter_vision_service_generate_description>

    @unittest.skipIf(
        not bool(os.getenv("OPENROUTER_API_KEY")),
        "OPENROUTER_API_KEY未设置，跳过集成测试"
    )
    def test_openrouter_vision_service_generate_description(self) -> None:
        """测试OpenRouter Vision服务生成描述（集成测试）"""
        with tempfile.TemporaryDirectory() as tmp:
            path = os.path.join(tmp, "test.jpg")
            image = Image.new("RGB", (200, 150), color=(255, 128, 64))
            image.save(path)

            api_key = self.config["OPENROUTER_API_KEY"]
            base_url = self.config.get("OPENROUTER_BASE_URL", "https://openrouter.ai/api/v1")

            service = OpenRouterVisionLLMService(
                api_key=api_key,
                base_url=base_url,
                server_host="localhost",
                server_port=5000,
                max_retries=2,
            )

>           result = service.generate_description(path)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

tests\test_vision_llm_service.py:101:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <utils.vision_llm_service.OpenRouterVisionLLMService object at 0x00000210FFEDF3D0>
image_path = 'C:\\Users\\86159\\AppData\\Local\\Temp\\tmpkpnj5ei5\\test.jpg'

    def generate_description(self, image_path: str) -> str:
        """
        生成图片描述（中文）。

        Args:
            image_path (str): 图片路径

        Returns:
            str: 描述文本
        """
        prompt = (
            "请用中文描述这张图片，包含以下要素：\n"
            "1. 场景描述（室内/室外，具体地点）\n"
            "2. 主要主体（人物、物体、动物等）\n"
            "3. 动作或状态（在做什么）\n"
            "4. 环境细节（光线、天气、背景）\n"
            "5. 情绪氛围（欢乐、温馨、宁静等）\n\n"
            "描述长度：50-200字"
        )
        image_url = self._get_image_url(image_path)
        messages = [
            {
                "role": "user",
                "content": [
                    {"type": "text", "text": prompt},
                    {"type": "image_url", "image_url": {"url": image_url}},
                ],
            }
        ]

        for attempt in range(self.max_retries):
            try:
                response = self.client.chat.completions.create(
                    model=self.model_name,
                    messages=messages,
                    temperature=0.2,
                    timeout=self.timeout,
                )
                content = response.choices[0].message.content.strip()
                if not content:
                    raise ValueError("Vision LLM返回空描述")
                return content
            except Exception as exc:
                if attempt == self.max_retries - 1:
>                   raise ValueError(f"生成描述失败: {exc}") from exc  # 捕获API调用失败，避免中断整体流程
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E                   ValueError: 生成描述失败: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata': {'raw': '{"error":{"code":"BadRequest","message":"The provided image url is not accessible.","param":null,"type":null}}', 'provider_name': 'Azure', 'is_byok': False}}, 'user_id': 'user_30twuG2y5I55gCwfq74EVMLScN9'}

utils\vision_llm_service.py:140: ValueError
____________________ VisionServiceTests.test_openrouter_vision_service_generate_description_batch _____________________

self = <utils.vision_llm_service.OpenRouterVisionLLMService object at 0x0000021057E959D0>
image_path = 'C:\\Users\\86159\\AppData\\Local\\Temp\\tmpphaawm8s\\test0.jpg'

    def generate_description(self, image_path: str) -> str:
        """
        生成图片描述（中文）。

        Args:
            image_path (str): 图片路径

        Returns:
            str: 描述文本
        """
        prompt = (
            "请用中文描述这张图片，包含以下要素：\n"
            "1. 场景描述（室内/室外，具体地点）\n"
            "2. 主要主体（人物、物体、动物等）\n"
            "3. 动作或状态（在做什么）\n"
            "4. 环境细节（光线、天气、背景）\n"
            "5. 情绪氛围（欢乐、温馨、宁静等）\n\n"
            "描述长度：50-200字"
        )
        image_url = self._get_image_url(image_path)
        messages = [
            {
                "role": "user",
                "content": [
                    {"type": "text", "text": prompt},
                    {"type": "image_url", "image_url": {"url": image_url}},
                ],
            }
        ]

        for attempt in range(self.max_retries):
            try:
>               response = self.client.chat.completions.create(
                    model=self.model_name,
                    messages=messages,
                    temperature=0.2,
                    timeout=self.timeout,
                )

utils\vision_llm_service.py:128:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\software\anaconda\envs\photo\Lib\site-packages\openai\_utils\_utils.py:286: in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\openai\resources\chat\completions\completions.py:1192: in create
    return self._post(
D:\software\anaconda\envs\photo\Lib\site-packages\openai\_base_client.py:1294: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <openai.OpenAI object at 0x0000021057E956D0>
cast_to = <class 'openai.types.chat.chat_completion.ChatCompletion'>
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...AppData%5CLocal%5CTemp%5Ctmpphaawm8s%5Ctest0.jpg'}}]}], 'model': 'openai/gpt-4o', 'temperature': 0.2}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -> ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)

        # create a copy of the options we were given so that if the
        # options are mutated later & we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()

        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)

        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)

            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)

            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth

            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects

            log.debug("Sending HTTP Request: %s %s", request.method, request.url)

            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)

                if remaining_retries > 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue

                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)

                if remaining_retries > 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue

                log.debug("Raising connection error")
                raise APIConnectionError(request=request) from err

            log.debug(
                'HTTP Response: %s %s "%i %s" %s',
                request.method,
                request.url,
                response.status_code,
                response.reason_phrase,
                response.headers,
            )
            log.debug("request_id: %s", response.headers.get("x-request-id"))

            try:
                response.raise_for_status()
            except httpx.HTTPStatusError as err:  # thrown on 4xx and 5xx status code
                log.debug("Encountered httpx.HTTPStatusError", exc_info=True)

                if remaining_retries > 0 and self._should_retry(err.response):
                    err.response.close()
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=response,
                    )
                    continue

                # If the response is streamed then we need to explicitly read the response
                # to completion before attempting to access the response text.
                if not err.response.is_closed:
                    err.response.read()

                log.debug("Re-raising status error")
>               raise self._make_status_error_from_response(err.response) from None
E               openai.BadRequestError: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata': {'raw': '{"error":{"code":"BadRequest","message":"The provided image url is not accessible.","param":null,"type":null}}', 'provider_name': 'Azure', 'is_byok': False}}, 'user_id': 'user_30twuG2y5I55gCwfq74EVMLScN9'}

D:\software\anaconda\envs\photo\Lib\site-packages\openai\_base_client.py:1067: BadRequestError

The above exception was the direct cause of the following exception:

self = <tests.test_vision_llm_service.VisionServiceTests testMethod=test_openrouter_vision_service_generate_description_batch>

    @unittest.skipIf(
        not bool(os.getenv("OPENROUTER_API_KEY")),
        "OPENROUTER_API_KEY未设置，跳过集成测试"
    )
    def test_openrouter_vision_service_generate_description_batch(self) -> None:
        """测试批量生成描述（集成测试）"""
        with tempfile.TemporaryDirectory() as tmp:
            paths = []
            for i in range(3):
                path = os.path.join(tmp, f"test{i}.jpg")
                image = Image.new("RGB", (100, 100), color=(i * 50, i * 50, i * 50))
                image.save(path)
                paths.append(path)

            api_key = self.config["OPENROUTER_API_KEY"]
            base_url = self.config.get("OPENROUTER_BASE_URL", "https://openrouter.ai/api/v1")

            service = OpenRouterVisionLLMService(
                api_key=api_key,
                base_url=base_url,
                server_host="localhost",
                server_port=5000,
                max_retries=2,
            )

>           results = service.generate_description_batch(paths)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

tests\test_vision_llm_service.py:132:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\vision_llm_service.py:157: in generate_description_batch
    descriptions.append(self.generate_description(image_path))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <utils.vision_llm_service.OpenRouterVisionLLMService object at 0x0000021057E959D0>
image_path = 'C:\\Users\\86159\\AppData\\Local\\Temp\\tmpphaawm8s\\test0.jpg'

    def generate_description(self, image_path: str) -> str:
        """
        生成图片描述（中文）。

        Args:
            image_path (str): 图片路径

        Returns:
            str: 描述文本
        """
        prompt = (
            "请用中文描述这张图片，包含以下要素：\n"
            "1. 场景描述（室内/室外，具体地点）\n"
            "2. 主要主体（人物、物体、动物等）\n"
            "3. 动作或状态（在做什么）\n"
            "4. 环境细节（光线、天气、背景）\n"
            "5. 情绪氛围（欢乐、温馨、宁静等）\n\n"
            "描述长度：50-200字"
        )
        image_url = self._get_image_url(image_path)
        messages = [
            {
                "role": "user",
                "content": [
                    {"type": "text", "text": prompt},
                    {"type": "image_url", "image_url": {"url": image_url}},
                ],
            }
        ]

        for attempt in range(self.max_retries):
            try:
                response = self.client.chat.completions.create(
                    model=self.model_name,
                    messages=messages,
                    temperature=0.2,
                    timeout=self.timeout,
                )
                content = response.choices[0].message.content.strip()
                if not content:
                    raise ValueError("Vision LLM返回空描述")
                return content
            except Exception as exc:
                if attempt == self.max_retries - 1:
>                   raise ValueError(f"生成描述失败: {exc}") from exc  # 捕获API调用失败，避免中断整体流程
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E                   ValueError: 生成描述失败: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata': {'raw': '{"error":{"code":"BadRequest","message":"The provided image url is not accessible.","param":null,"type":null}}', 'provider_name': 'Azure', 'is_byok': False}}, 'user_id': 'user_30twuG2y5I55gCwfq74EVMLScN9'}

utils\vision_llm_service.py:140: ValueError
================================================== warnings summary ===================================================
<frozen importlib._bootstrap>:241
  <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

<frozen importlib._bootstrap>:241
  <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

<frozen importlib._bootstrap>:241
  <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type swigvarlink has no __module__ attribute

tests/test_embedding_service.py::EmbeddingServiceTests::test_t5_embedding_service_init
  D:\software\anaconda\envs\photo\Lib\site-packages\huggingface_hub\file_download.py:130: UserWarning: `huggingface_hub` cache-system uses symlinks by default to efficiently store duplicated files but your machine does not support them in C:\Users\86159\.cache\huggingface\hub\models--sentence-transformers--sentence-t5-base. Caching files will still work but in a degraded version that might require more space on your disk. This warning can be disabled by setting the `HF_HUB_DISABLE_SYMLINKS_WARNING` environment variable. For more details, see https://huggingface.co/docs/huggingface_hub/how-to-cache#limitations.
  To support symlinks on Windows, you either need to activate Developer Mode or to run Python as an administrator. In order to activate developer mode, see this article: https://docs.microsoft.com/en-us/windows/apps/get-started/enable-your-device-for-development
    warnings.warn(message)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=============================================== short test summary info ===============================================
FAILED tests/test_embedding_service.py::EmbeddingServiceTests::test_t5_embedding_service_init - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_build_index_fails_when_no_photos - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_compute_fallback_ratio - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_generate_description_with_local_service - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_get_status_initial - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_scan_photos_empty_directory - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_scan_photos_filters_and_sorts - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_distance_to_score - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_get_index_stats_not_loaded - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_parse_date_datetime_format - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_parse_date_invalid - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_parse_date_iso_format - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_search_without_loaded_index - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_validate_query_invalid_chars - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_validate_query_short - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_validate_query_valid - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_vector_store.py::VectorStoreTests::test_add_and_search_item - TypeError: '>' not supported between instances of 'dict' and 'float'
FAILED tests/test_vision_llm_service.py::VisionServiceTests::test_openrouter_vision_service_generate_description - ValueError: 生成描述失败: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata...
FAILED tests/test_vision_llm_service.py::VisionServiceTests::test_openrouter_vision_service_generate_description_batch - ValueError: 生成描述失败: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata...
================================ 19 failed, 31 passed, 4 warnings in 519.45s (0:08:39) ================================

测试失败，退出码：1