(photo) PS C:\Users\86159\Desktop\Photo_Search_Engine> python .\run_tests.py --integration
运行模式：集成测试（需要API密钥）
================================================= test session starts =================================================
platform win32 -- Python 3.11.14, pytest-9.0.2, pluggy-1.6.0
rootdir: C:\Users\86159\Desktop\Photo_Search_Engine
plugins: anyio-4.12.1
collected 50 items

tests\test_embedding_service.py .F...F                                                                           [ 12%]
tests\test_image_parser.py ........                                                                              [ 28%]
tests\test_indexer.py FFFF.FF                                                                                    [ 42%]
tests\test_searcher.py FFFFFFFFF                                                                                 [ 60%]
tests\test_time_parser.py .....                                                                                  [ 70%]
tests\test_vector_store.py F.......                                                                              [ 86%]
tests\test_vision_llm_service.py ...FF..                                                                         [100%]

====================================================== FAILURES =======================================================
__________________________ EmbeddingServiceTests.test_embedding_vector_dimension_consistency __________________________

self = <tests.test_embedding_service.EmbeddingServiceTests testMethod=test_embedding_vector_dimension_consistency>

    @unittest.skipIf(
        not bool(os.getenv("OPENROUTER_API_KEY")),
        "OPENROUTER_API_KEY未设置，跳过集成测试"
    )
    def test_embedding_vector_dimension_consistency(self) -> None:
        """测试相同文本生成相同维度的向量（集成测试）"""
        api_key = self.config["OPENROUTER_API_KEY"]
        base_url = self.config.get("OPENROUTER_BASE_URL", "https://openrouter.ai/api/v1")

        service = OpenAIEmbeddingService(
            api_key=api_key,
            model_name="openai/text-embedding-3-small",
            base_url=base_url,
        )

        result1 = service.generate_embedding("相同文本")
        result2 = service.generate_embedding("相同文本")

        self.assertEqual(len(result1), len(result2))
        # 向量应该非常接近（浮点数精度）
>       self.assertTrue(
            all(abs(a - b) < 1e-6 for a, b in zip(result1, result2))
        )
E       AssertionError: False is not true

tests\test_embedding_service.py:104: AssertionError
________________________________ EmbeddingServiceTests.test_t5_embedding_service_init _________________________________

self = <tests.test_embedding_service.EmbeddingServiceTests testMethod=test_t5_embedding_service_init>

    def test_t5_embedding_service_init(self) -> None:
        """测试T5 Embedding服务初始化"""
        try:
>           service = T5EmbeddingService(model_name="sentence-t5-base", device="cuda")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

tests\test_embedding_service.py:79:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 999.60it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   2%|▏         | 2/99 [00:00<00:00, 999.71it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   2%|▏         | 2/99 [00:00<00:00, 999.71it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 749.88it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 519.83it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 515.62it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 515.62it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 644.52it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 644.52it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 773.43it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 773.43it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 902.33it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 902.33it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 862.40it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 862.40it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 970.20it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 970.20it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 1078.01it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1078.01it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1185.81it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1067.23it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1164.25it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1164.25it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1150.12it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1150.12it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1137.95it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1137.95it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1127.58it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1048.72it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1045.54it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1045.54it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 600.64it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 600.64it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 614.26it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 614.26it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 606.98it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 588.20it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 600.54it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 583.05it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 594.79it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 594.79it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 623.12it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 623.12it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 633.80it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 633.80it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 643.23it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 643.23it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 652.91it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 636.26it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 645.21it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 645.21it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 653.79it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 653.79it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 662.10it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 662.10it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 685.75it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 669.92it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 693.02it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 693.02it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 716.12it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 716.12it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 739.22it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 722.57it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 745.15it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 745.15it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 767.73it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 767.73it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 790.31it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 790.31it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 794.94it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 794.94it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 817.02it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 817.02it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 839.10it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 839.10it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 842.59it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 842.59it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 864.19it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 864.19it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 885.79it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 885.79it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 907.40it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 888.20it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 909.35it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 909.35it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 930.50it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 930.50it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 951.65it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 951.65it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 952.19it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 952.19it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 972.89it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 953.29it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 973.57it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 973.57it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 973.73it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 973.73it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 993.60it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 993.60it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 993.85it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 993.85it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1013.33it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1013.33it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1032.82it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1032.82it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1032.21it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1032.21it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1051.32it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1051.32it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1070.44it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1070.44it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1068.66it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1068.66it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1087.40it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1087.40it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1085.89it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1085.89it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1104.30it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1084.36it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1102.44it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1102.44it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1100.66it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1100.66it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1118.41it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1118.41it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1116.35it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1116.35it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1114.33it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1114.33it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1112.64it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1112.64it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1129.50it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1110.51it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1127.08it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1127.08it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1143.66it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1125.07it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1141.38it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1141.38it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1157.68it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1157.68it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1173.99it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1173.99it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1171.19it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1171.19it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1187.24it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1168.52it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1184.31it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1184.31it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1181.43it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1181.43it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1187.10it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1187.10it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1202.52it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1183.48it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1198.65it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1198.65it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1195.77it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1195.77it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1210.72it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1210.72it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1207.74it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1207.74it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1222.47it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1204.73it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1219.24it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1219.24it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1233.76it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1216.10it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1230.40it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1230.40it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1227.16it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1227.16it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1241.26it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1224.01it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1237.91it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1237.91it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1234.24it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1234.24it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1247.96it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1231.08it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1244.61it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1244.61it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1241.35it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1241.35it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1254.70it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1254.70it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1251.33it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1251.33it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1264.50it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1248.06it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1261.06it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1261.06it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1274.06it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1254.45it/s, Materializing param=encoder.final_layer_norm.weight]
_________________________________ IndexerTests.test_build_index_fails_when_no_photos __________________________________

self = <tests.test_indexer.IndexerTests testMethod=test_build_index_fails_when_no_photos>

    def test_build_index_fails_when_no_photos(self) -> None:
        """测试无照片时构建索引失败"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            data_dir = os.path.join(tmp, "data")
            os.makedirs(photo_dir)
            os.makedirs(data_dir)

            index_path = os.path.join(data_dir, "photo_search.index")
            metadata_path = os.path.join(data_dir, "metadata.json")
            vector_store = VectorStore(768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=data_dir,
                batch_size=5,
            )

tests\test_indexer.py:181:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1007.28it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1003.90it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 668.26it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 600.93it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 272.87it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 308.08it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 235.33it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 250.17it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 250.17it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 250.12it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 250.12it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 259.31it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 233.38it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 250.16it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 250.16it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 272.79it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 264.87it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 294.30it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 285.34it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 304.97it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 296.75it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 307.16it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 292.19it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 294.98it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 276.28it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 291.34it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 291.34it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 305.60it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 305.60it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 303.96it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 303.96it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 302.63it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 297.24it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 304.04it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 304.04it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 307.86it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 305.52it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 311.51it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 306.73it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 312.51it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 307.89it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 300.42it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 292.44it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 294.05it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 290.34it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 299.18it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 291.85it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 293.32it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 289.92it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 296.19it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 292.76it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 297.33it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 294.10it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 298.53it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 295.34it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 302.70it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 302.70it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 303.62it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 300.58it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 298.63it/s, Materializing param=encoder.embed_tokens.weight]      Loading weights: 100%|██████████| 99/99 [00:00<00:00, 580.77it/s, Materializing param=encoder.final_layer_norm.weight]
-------------------------------------------------- Captured log call --------------------------------------------------
WARNING  huggingface_hub.utils._http:_http.py:779 Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
______________________________________ IndexerTests.test_compute_fallback_ratio _______________________________________

self = <tests.test_indexer.IndexerTests testMethod=test_compute_fallback_ratio>

    def test_compute_fallback_ratio(self) -> None:
        """测试降级描述占比计算"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            data_dir = os.path.join(tmp, "data")
            os.makedirs(photo_dir)
            os.makedirs(data_dir)

            index_path = os.path.join(data_dir, "index.bin")
            metadata_path = os.path.join(data_dir, "metadata.json")
            vector_store = VectorStore(768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=data_dir,
            )

tests\test_indexer.py:206:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1011.16it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 781.50it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 971.80it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 971.80it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1295.74it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1295.74it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1250.31it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1250.31it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 921.22it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 798.46it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 931.54it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 931.54it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 936.46it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 936.46it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 852.83it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 852.83it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 865.54it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 865.54it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 877.24it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 877.24it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 956.98it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 956.98it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1036.73it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1036.73it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1032.61it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1032.61it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1031.71it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1031.71it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 966.58it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 966.58it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 968.54it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 968.54it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1025.52it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 970.83it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 971.31it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 924.42it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 886.69it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 848.99it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 837.22it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 837.22it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 811.46it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 811.46it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 827.09it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 827.09it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 832.40it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 832.40it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 867.08it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 867.08it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 816.86it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 816.86it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 822.41it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 822.41it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 803.92it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 803.92it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 832.63it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 809.40it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 793.05it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 793.05it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 778.33it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 778.33it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 803.43it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 783.76it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 788.93it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 788.93it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 812.84it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 793.85it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 817.20it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 798.26it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 821.07it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 803.02it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 825.33it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 825.33it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 829.14it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 829.14it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 850.96it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 832.78it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 854.13it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 854.13it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 839.83it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 839.83it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 810.34it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 795.01it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 813.94it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 798.83it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 788.12it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 788.12it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 791.85it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 778.15it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 781.90it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 781.90it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 785.77it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 785.77it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 802.49it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 802.49it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 805.51it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 805.51it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 821.95it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 821.95it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 838.39it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 838.39it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 840.99it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 840.99it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 857.17it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 857.17it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 859.44it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 859.44it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 875.35it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 875.35it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 877.33it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 877.33it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 893.00it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 893.00it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 894.65it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 894.65it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 896.16it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 896.16it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 911.35it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 897.93it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 912.90it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 912.90it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 927.86it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 914.22it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 928.97it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 928.97it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 929.94it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 929.94it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 944.47it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 930.80it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 945.12it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 945.12it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 959.44it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 945.90it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 960.02it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 946.65it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 960.57it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 960.57it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 961.14it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 961.14it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 974.87it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 974.87it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 975.36it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 975.36it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 988.91it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 975.73it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 989.09it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 989.09it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 989.26it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 989.26it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1002.45it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1002.45it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1015.64it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1015.64it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1028.83it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1028.83it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1028.18it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1028.18it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1041.19it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1041.19it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1054.21it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1054.21it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1067.22it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1053.55it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1066.40it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1066.40it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1079.25it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1079.25it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1092.10it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1078.25it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1090.94it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1090.94it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1089.43it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1089.43it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1101.96it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1088.35it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1100.72it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1100.72it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1099.49it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1099.49it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1111.70it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1111.70it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1110.35it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1110.35it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1109.03it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1109.03it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1120.96it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1120.96it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1119.54it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1119.54it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1131.32it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1118.15it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1129.80it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1116.78it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1128.29it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1126.99it/s, Materializing param=encoder.final_layer_norm.weight]
______________________________ IndexerTests.test_generate_description_with_local_service ______________________________

self = <tests.test_indexer.IndexerTests testMethod=test_generate_description_with_local_service>

    def test_generate_description_with_local_service(self) -> None:
        """测试使用本地Vision服务生成描述"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            os.makedirs(photo_dir)

            img_path = os.path.join(photo_dir, "test.jpg")
            _create_image(img_path, size=(100, 80))

            index_path = os.path.join(tmp, "index.bin")
            metadata_path = os.path.join(tmp, "metadata.json")
            vector_store = VectorStore(dimension=768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=tmp,
            )

tests\test_indexer.py:135:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1999.67it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1999.67it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1501.18it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 852.15it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 773.79it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 773.79it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 809.02it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 809.02it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 733.89it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 733.89it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 640.24it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 640.24it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 731.70it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 669.00it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 752.63it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 752.63it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 771.81it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 771.81it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 759.14it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 666.63it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 685.70it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 685.70it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 702.73it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 666.74it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 651.20it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 651.20it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 666.75it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 666.75it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 666.12it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 666.12it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 628.72it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 628.72it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 641.73it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 641.73it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 654.09it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 611.96it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 624.08it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 624.08it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 635.44it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 635.44it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 636.15it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 618.09it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 646.19it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 628.56it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 638.60it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 621.90it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 631.60it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 615.89it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 640.52it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 625.12it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 633.85it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 633.85it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 642.28it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 642.28it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 657.33it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 657.33it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 679.99it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 679.99it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 686.89it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 671.78it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 678.77it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 678.77it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 671.49it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 658.11it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 664.78it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 664.78it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 658.56it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 658.56it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 658.36it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 658.36it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 652.67it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 652.67it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 647.58it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 647.58it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 664.63it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 653.53it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 670.29it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 670.29it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 675.58it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 675.58it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 680.82it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 680.82it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 685.89it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 685.89it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 685.20it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 685.20it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 679.33it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 679.33it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 674.09it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 664.35it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 678.79it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 669.13it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 673.77it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 673.77it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 678.29it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 678.29it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 682.77it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 682.77it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 687.09it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 687.09it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 700.56it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 700.56it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 708.96it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 708.96it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 722.34it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 722.34it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 735.72it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 735.72it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 749.09it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 749.09it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 752.48it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 752.48it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 765.68it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 765.68it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 778.88it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 778.88it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 792.08it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 781.61it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 794.64it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 794.64it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 797.26it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 797.26it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 810.12it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 810.12it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 812.54it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 812.54it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 814.89it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 814.89it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 827.42it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 817.18it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 829.56it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 829.56it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 831.75it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 831.75it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 833.70it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 833.70it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 845.78it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 845.78it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 857.86it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 842.38it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 854.25it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 854.25it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 855.66it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 855.66it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 867.39it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 857.34it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 868.92it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 868.92it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 870.42it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 870.42it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 881.88it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 881.88it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 883.21it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 883.21it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 894.54it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 894.54it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 895.80it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 895.80it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 896.29it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 896.29it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 907.35it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 907.35it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 908.37it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 908.37it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 919.32it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 909.36it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 920.19it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 920.19it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 931.01it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 931.01it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 926.69it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 926.69it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 937.34it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 927.21it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 937.74it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 937.74it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 938.42it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 938.42it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 948.85it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 948.85it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 949.38it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 949.38it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 949.90it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 949.90it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 960.11it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 960.11it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 960.52it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 960.52it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 970.63it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 970.63it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 971.05it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 971.05it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 971.22it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 971.22it/s, Materializing param=encoder.embed_tokens.weight]      Loading weights: 100%|██████████| 99/99 [00:00<00:00, 971.51it/s, Materializing param=encoder.final_layer_norm.weight]
________________________________________ IndexerTests.test_get_status_initial _________________________________________

self = <tests.test_indexer.IndexerTests testMethod=test_get_status_initial>

    def test_get_status_initial(self) -> None:
        """测试获取初始状态"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            os.makedirs(photo_dir)

            index_path = os.path.join(tmp, "index.bin")
            metadata_path = os.path.join(tmp, "metadata.json")
            vector_store = VectorStore(dimension=768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=tmp,
            )

tests\test_indexer.py:157:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1001.03it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1000.55it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1000.55it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1000.55it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 600.19it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 667.78it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 667.78it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 714.09it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 714.09it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 499.28it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 458.76it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 388.88it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 368.44it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 363.67it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 320.00it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 321.44it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 310.35it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 333.35it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 333.35it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 343.49it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 333.07it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 352.07it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 342.26it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 333.21it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 316.88it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 325.39it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 318.00it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 325.91it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 322.12it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 336.31it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 329.40it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 336.14it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 329.62it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 349.01it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 326.48it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 338.48it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 326.36it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 338.09it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 332.13it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 332.62it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 327.44it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 327.70it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 327.70it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 332.71it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 327.93it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 332.71it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 328.16it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 328.37it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 324.10it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 328.56it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 328.56it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 324.71it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 320.61it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 328.94it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 323.67it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 329.97it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 329.97it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 333.44it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 318.47it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 316.90it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 310.55it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 317.41it/s, Materializing param=encoder.embed_tokens.weight]      Loading weights: 100%|██████████| 99/99 [00:00<00:00, 584.17it/s, Materializing param=encoder.final_layer_norm.weight]
____________________________________ IndexerTests.test_scan_photos_empty_directory ____________________________________

self = <tests.test_indexer.IndexerTests testMethod=test_scan_photos_empty_directory>

    def test_scan_photos_empty_directory(self) -> None:
        """测试扫描空目录"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            os.makedirs(photo_dir)

            index_path = os.path.join(tmp, "index.bin")
            metadata_path = os.path.join(tmp, "metadata.json")
            vector_store = VectorStore(dimension=768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=tmp,
            )

tests\test_indexer.py:111:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<00:00, 998.17it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   2%|▏         | 2/99 [00:00<00:00, 998.17it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 556.00it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 356.87it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 322.18it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 298.15it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 324.14it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 324.14it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 267.60it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 256.26it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 286.48it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 259.96it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 276.29it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 276.29it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 295.29it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 276.94it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 298.54it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 289.70it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 301.27it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 297.13it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 299.76it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 292.36it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 309.28it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 294.41it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 309.61it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 303.33it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 318.04it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 293.21it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 302.65it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 302.65it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 306.94it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 306.94it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 319.19it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 308.17it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 319.87it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 311.86it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 312.69it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 312.69it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 313.56it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 310.74it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 320.30it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 317.43it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 326.95it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 322.45it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 336.47it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 331.83it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 345.66it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 336.38it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 345.19it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 345.19it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 338.08it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 326.86it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 334.89it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 330.87it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 338.75it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 334.77it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 338.15it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 335.89it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 343.21it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 339.38it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 346.59it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 346.59it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 353.60it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 353.60it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 360.37it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 360.37it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 363.30it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 359.57it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 366.13it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 366.13it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 371.75it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 365.68it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 371.78it/s, Materializing param=encoder.embed_tokens.weight]      Loading weights: 100%|██████████| 99/99 [00:00<00:00, 611.85it/s, Materializing param=encoder.final_layer_norm.weight]
___________________________________ IndexerTests.test_scan_photos_filters_and_sorts ___________________________________

self = <tests.test_indexer.IndexerTests testMethod=test_scan_photos_filters_and_sorts>

    def test_scan_photos_filters_and_sorts(self) -> None:
        """测试扫描照片-过滤和排序"""
        with tempfile.TemporaryDirectory() as tmp:
            photo_dir = os.path.join(tmp, "photos")
            os.makedirs(photo_dir)

            img1 = os.path.join(photo_dir, "a.jpg")
            img2 = os.path.join(photo_dir, "b.jpg")
            txt = os.path.join(photo_dir, "readme.txt")
            sub_dir = os.path.join(photo_dir, "sub")
            os.makedirs(sub_dir)
            img3 = os.path.join(sub_dir, "c.jpg")

            _create_image(img1)
            _create_image(img2)
            _create_image(img3)
            with open(txt, "w", encoding="utf-8") as file:
                file.write("x")

            os.utime(img1, (1, 1))
            os.utime(img2, (2, 2))
            os.utime(img3, (3, 3))

            index_path = os.path.join(tmp, "index.bin")
            metadata_path = os.path.join(tmp, "metadata.json")
            vector_store = VectorStore(dimension=768, index_path=index_path, metadata_path=metadata_path)

            indexer = Indexer(
                photo_dir=photo_dir,
                vision=LocalVisionLLMService(),
>               embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                vector_store=vector_store,
                data_dir=tmp,
            )

tests\test_indexer.py:87:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1004.62it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1333.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1333.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 2000.14it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 2000.14it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 2666.86it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 2666.86it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1994.82it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1426.63it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1711.96it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1330.61it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1552.38it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1552.38it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1451.07it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1228.97it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1198.49it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1198.49it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 1331.65it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1331.65it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1464.82it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1464.82it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1410.36it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1261.95it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1367.11it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1236.89it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1332.04it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1332.04it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1303.06it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1198.94it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1184.31it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1184.31it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1029.63it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1029.63it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1027.97it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1027.97it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 948.80it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 862.30it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 907.68it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 849.64it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 819.23it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 819.23it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 858.24it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 826.78it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 864.36it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 832.95it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 869.17it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 869.17it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 873.89it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 873.89it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 855.91it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 828.37it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 860.23it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 860.23it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 864.68it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 838.63it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 868.58it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 868.58it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 872.47it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 872.47it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 901.56it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 876.08it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 878.57it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 878.57it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 882.72it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 882.72it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 909.47it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 881.76it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 884.67it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 884.67it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 876.58it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 876.58it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 900.93it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 900.93it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 903.13it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 903.13it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 905.21it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 884.71it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 887.36it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 872.40it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 874.98it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 874.98it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 896.32it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 877.60it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 879.50it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 862.20it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 882.26it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 857.70it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 848.74it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 835.53it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 837.64it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 837.64it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 839.29it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 826.64it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 815.54it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 815.54it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 818.63it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 818.63it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 808.30it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 808.30it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 798.59it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 798.59it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 801.74it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 801.74it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 737.53it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 727.35it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 741.07it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 741.07it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 744.49it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 744.49it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 758.03it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 758.03it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 771.56it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 771.56it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 774.61it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 774.61it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 787.97it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 777.57it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 790.75it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 790.75it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 803.93it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 793.46it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 806.46it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 806.46it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 808.96it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 808.96it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 821.80it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 821.80it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 824.02it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 824.02it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 836.70it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 836.70it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 849.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 849.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 862.06it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 851.31it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 863.83it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 863.83it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 876.35it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 876.35it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 888.87it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 888.87it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 890.24it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 890.24it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 902.61it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 902.61it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 914.97it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 914.97it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 915.99it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 915.99it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 928.21it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 928.21it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 940.42it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 940.42it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 941.15it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 941.15it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 953.21it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 953.21it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 965.28it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 965.28it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 965.67it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 965.67it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 977.59it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 977.59it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 989.52it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 989.52it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 989.67it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 989.67it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 989.77it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 989.77it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 989.91it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 989.91it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1001.42it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1001.42it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1001.36it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1001.36it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1006.91it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1006.91it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1018.23it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1018.23it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1029.54it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1017.91it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1029.10it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1029.10it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1040.28it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1028.77it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1039.83it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1039.83it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1050.89it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1050.89it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1061.96it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1061.96it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1061.30it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1061.30it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1072.24it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1071.47it/s, Materializing param=encoder.final_layer_norm.weight]
________________________________________ SearcherTests.test_distance_to_score _________________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_distance_to_score>

    def test_distance_to_score(self) -> None:
        """测试L2距离转换为相似度分数"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:62:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1000.07it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 999.60it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   2%|▏         | 2/99 [00:00<00:00, 999.60it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 999.83it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 749.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 571.96it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 500.62it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 555.42it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 384.57it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 353.11it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 353.11it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 388.79it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 333.29it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 333.29it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 333.29it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 360.00it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 346.14it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 370.35it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 357.10it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 333.31it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 314.36it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 324.39it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 315.85it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 325.69it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 317.61it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 321.03it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 309.66it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 312.58it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 312.58it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 326.61it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 313.76it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 320.77it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 314.90it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 327.28it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 321.50it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 333.33it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 327.58it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 327.88it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 319.95it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 315.62it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 302.03it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 311.86it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 307.58it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 317.14it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 312.80it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 317.71it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 313.57it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 322.45it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 322.45it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 326.89it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 318.89it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 319.43it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 315.69it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 327.38it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 323.57it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 323.91it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 320.35it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 317.33it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 314.06it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 308.38it/s, Materializing param=encoder.embed_tokens.weight]      Loading weights: 100%|██████████| 99/99 [00:00<00:00, 514.97it/s, Materializing param=encoder.final_layer_norm.weight]
____________________________________ SearcherTests.test_get_index_stats_not_loaded ____________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_get_index_stats_not_loaded>

    def test_get_index_stats_not_loaded(self) -> None:
        """测试获取索引统计-未加载"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:123:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1001.98it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1001.86it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 667.35it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 750.28it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 600.44it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 668.44it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 668.44it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 835.55it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 713.92it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 750.21it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   6%|▌         | 6/99 [00:00<00:00, 750.21it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 777.81it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 777.81it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 797.87it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 797.87it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 691.07it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 599.02it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 624.02it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  10%|█         | 10/99 [00:00<00:00, 624.02it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 646.14it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  11%|█         | 11/99 [00:00<00:00, 646.14it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 665.79it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 665.79it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 610.57it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 590.11it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 607.47it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 582.12it/s, Materializing param=encoder.block.1.layer.0.layer_normLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 608.27it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 584.21it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 575.15it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 575.15it/s, Materializing param=encoder.block.1.layer.1.DenseReluDLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 570.30it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 552.00it/s, Materializing param=encoder.block.1.layer.1.layer_normLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 548.81it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 548.81it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 545.83it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 545.83it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 543.37it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 538.26it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 557.51it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 557.51it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 568.80it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 568.80it/s, Materializing param=encoder.block.2.layer.0.layer_normLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 594.66it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 594.66it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 604.91it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 589.75it/s, Materializing param=encoder.block.2.layer.1.DenseReluDLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 580.62it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 565.25it/s, Materializing param=encoder.block.2.layer.1.layer_normLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 587.86it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 575.69it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 585.06it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 572.82it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 570.74it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 558.15it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 567.53it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 556.62it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 565.46it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 565.46it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 584.31it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 584.31it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 592.07it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 592.07it/s, Materializing param=encoder.block.3.layer.1.DenseReluDLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 610.57it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 610.57it/s, Materializing param=encoder.block.3.layer.1.layer_normLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 617.67it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 617.67it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 613.37it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 613.37it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 609.54it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 599.37it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 616.02it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 596.17it/s, Materializing param=encoder.block.4.layer.0.SelfAttentLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 602.58it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 593.18it/s, Materializing param=encoder.block.4.layer.0.layer_normLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 599.16it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 581.64it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 587.68it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  40%|████      | 40/99 [00:00<00:00, 587.68it/s, Materializing param=encoder.block.4.layer.1.DenseReluDLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 593.32it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 593.32it/s, Materializing param=encoder.block.4.layer.1.layer_normLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 607.79it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 607.79it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 622.26it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 622.26it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 626.97it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 626.97it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 641.22it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 641.22it/s, Materializing param=encoder.block.5.layer.0.SelfAttentLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 655.47it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 655.47it/s, Materializing param=encoder.block.5.layer.0.layer_normLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 661.48it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 661.48it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 675.56it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 675.56it/s, Materializing param=encoder.block.5.layer.1.DenseReluDLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 689.63it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 689.63it/s, Materializing param=encoder.block.5.layer.1.layer_normLoading weights:  51%|█████     | 50/99 [00:00<00:00, 703.71it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  51%|█████     | 50/99 [00:00<00:00, 703.71it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 707.09it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 707.09it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 720.96it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 711.57it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 725.25it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 725.25it/s, Materializing param=encoder.block.6.layer.0.SelfAttentLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 728.39it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 728.39it/s, Materializing param=encoder.block.6.layer.0.layer_normLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 741.88it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 731.79it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 745.09it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 745.09it/s, Materializing param=encoder.block.6.layer.1.DenseReluDLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 748.67it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 748.67it/s, Materializing param=encoder.block.6.layer.1.layer_normLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 761.80it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 761.80it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 764.56it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 764.56it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 768.75it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  61%|██████    | 60/99 [00:00<00:00, 768.75it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 781.56it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 781.56it/s, Materializing param=encoder.block.7.layer.0.SelfAttentLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 782.25it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 782.25it/s, Materializing param=encoder.block.7.layer.0.layer_normLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 785.83it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 785.83it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 798.31it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 789.64it/s, Materializing param=encoder.block.7.layer.1.DenseReluDLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 801.98it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 801.98it/s, Materializing param=encoder.block.7.layer.1.layer_normLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 804.24it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 804.24it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 816.43it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 816.43it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 817.49it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 817.49it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 829.51it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 829.51it/s, Materializing param=encoder.block.8.layer.0.SelfAttentLoading weights:  71%|███████   | 70/99 [00:00<00:00, 831.38it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  71%|███████   | 70/99 [00:00<00:00, 831.38it/s, Materializing param=encoder.block.8.layer.0.layer_normLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 843.26it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 833.41it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 845.15it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 845.15it/s, Materializing param=encoder.block.8.layer.1.DenseReluDLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 850.42it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 850.42it/s, Materializing param=encoder.block.8.layer.1.layer_normLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 862.07it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 862.07it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 873.72it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 873.72it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 885.37it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 885.37it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 885.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 885.29it/s, Materializing param=encoder.block.9.layer.0.SelfAttentLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 896.79it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 896.79it/s, Materializing param=encoder.block.9.layer.0.layer_normLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 908.29it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 908.29it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 919.79it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  81%|████████  | 80/99 [00:00<00:00, 919.79it/s, Materializing param=encoder.block.9.layer.1.DenseReluDLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 931.28it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 913.60it/s, Materializing param=encoder.block.9.layer.1.layer_normLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 924.87it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 924.87it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 936.15it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 936.15it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 928.76it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 928.76it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 939.82it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 939.82it/s, Materializing param=encoder.block.10.layer.0.SelfAttenLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 950.87it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 933.53it/s, Materializing param=encoder.block.10.layer.0.layer_norLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 944.39it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 944.39it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 955.24it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 955.24it/s, Materializing param=encoder.block.10.layer.1.DenseReluLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 947.19it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 947.19it/s, Materializing param=encoder.block.10.layer.1.layer_norLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 957.83it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 957.83it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 968.48it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 968.48it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 961.45it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 961.45it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 961.13it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 961.13it/s, Materializing param=encoder.block.11.layer.0.SelfAttenLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 971.47it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 971.47it/s, Materializing param=encoder.block.11.layer.0.layer_norLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 981.80it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 965.60it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 975.76it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 975.76it/s, Materializing param=encoder.block.11.layer.1.DenseReluLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 974.76it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 966.06it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 976.02it/s, Materializing param=encoder.block.11.layer.1.layer_norLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 976.02it/s, Materializing param=encoder.embed_tokens.weight]      Loading weights: 100%|██████████| 99/99 [00:00<00:00, 976.33it/s, Materializing param=encoder.final_layer_norm.weight]
____________________________________ SearcherTests.test_parse_date_datetime_format ____________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_parse_date_datetime_format>

    def test_parse_date_datetime_format(self) -> None:
        """测试datetime格式日期解析"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:96:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   3%|▎         | 3/99 [00:00<00:00, 2404.53it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 2404.53it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 3206.04it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 3206.04it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 4007.55it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 2898.22it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 3477.86it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 3477.86it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 3136.10it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 3136.10it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 2470.51it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 2090.62it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1859.18it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1859.18it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 2065.75it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 2065.75it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1884.62it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1884.62it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1755.80it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1755.80it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1659.80it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1471.57it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1584.76it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1584.76it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1525.79it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1384.78it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1477.10it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1352.24it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1324.94it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1324.94it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1402.88it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1402.88it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1373.78it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1373.78it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1348.50it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1348.50it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1415.92it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1415.92it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1307.12it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1307.12it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1366.53it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1289.85it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1345.93it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1345.93it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1327.43it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1327.43it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1380.53it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1310.56it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1360.97it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1360.97it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1343.59it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1343.59it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1391.58it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1327.82it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  30%|███       | 30/99 [00:00<00:00, 1313.55it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  30%|███       | 30/99 [00:00<00:00, 1313.55it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1357.34it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1300.40it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1342.35it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1342.35it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1277.16it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1277.16it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1315.86it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1315.86it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1304.09it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1304.09it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1293.19it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1293.19it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1282.81it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1239.98it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1273.49it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1273.49it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1264.58it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1264.58it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1256.28it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1256.28it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1248.30it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1248.30it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1278.75it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1278.75it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1270.64it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1270.64it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1300.19it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1281.02it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1310.14it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1310.14it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1339.25it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1339.25it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1329.35it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1329.35it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1357.64it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1357.64it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1385.92it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1385.92it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1375.37it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1375.37it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1402.88it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1402.88it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1430.39it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1430.39it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1457.89it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1411.11it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1437.74it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1437.74it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1464.36it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1464.36it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1490.99it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1490.99it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1478.04it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1478.04it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1503.97it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1503.97it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1529.90it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1529.90it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1516.26it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1516.26it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1541.53it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1541.53it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1566.80it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1566.80it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1592.07it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1592.07it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1577.58it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1577.58it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1602.22it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1602.22it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1626.87it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1626.87it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1611.58it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1611.58it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1635.64it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1635.64it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1659.69it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1659.69it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1683.74it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1644.16it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1667.65it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1667.65it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1691.14it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1691.14it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1714.63it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1714.63it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1698.18it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1698.18it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1721.13it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1721.13it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1744.08it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1705.12it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1727.56it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1727.56it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1749.99it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1749.99it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1733.57it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1733.57it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1755.52it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1755.52it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1777.46it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1777.46it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1759.69it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1759.69it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1781.15it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1781.15it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1802.61it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1802.61it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1824.07it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1786.76it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1807.78it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1807.78it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1828.80it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1828.80it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1849.82it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1849.82it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1832.33it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1832.33it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1852.92it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1852.92it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1873.50it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1873.50it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1894.09it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1894.09it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1875.90it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1875.90it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1896.07it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1896.07it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1916.24it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1916.24it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1936.41it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1936.41it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1918.02it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1918.02it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1937.80it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1957.57it/s, Materializing param=encoder.final_layer_norm.weight]
________________________________________ SearcherTests.test_parse_date_invalid ________________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_parse_date_invalid>

    def test_parse_date_invalid(self) -> None:
        """测试无效日期解析"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:111:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1990.18it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1990.18it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1497.07it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1497.07it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1332.05it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1332.05it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1045.86it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1045.86it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1037.38it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1037.38it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1031.77it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1031.77it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1179.17it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1027.70it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1156.16it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1156.16it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 1284.63it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1138.43it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1252.27it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1252.27it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1366.11it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1226.55it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1205.21it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1205.21it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1187.47it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1187.47it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1272.29it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1272.29it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1251.61it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1204.31it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1279.58it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1279.58it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1259.68it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1259.68it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1329.66it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1329.66it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1308.14it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1308.14it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1289.16it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1289.16it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1272.47it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1272.47it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1257.38it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1257.38it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1244.05it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1244.05it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1258.72it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1258.72it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1246.07it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1246.07it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1293.99it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1234.88it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1224.56it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1224.56it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1215.16it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1215.16it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  30%|███       | 30/99 [00:00<00:00, 1206.47it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  30%|███       | 30/99 [00:00<00:00, 1206.47it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1246.69it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1246.69it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1237.20it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1237.20it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1275.86it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1275.86it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1314.53it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1314.53it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1353.19it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1353.19it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1340.06it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1340.06it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1377.28it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1377.28it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1414.50it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1414.50it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1451.73it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1399.62it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1435.51it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1435.51it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1471.40it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1471.40it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1454.95it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1454.95it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1489.59it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1489.59it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1524.23it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1524.23it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1506.74it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1506.74it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1540.23it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1540.23it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1573.71it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1573.71it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1607.19it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1555.17it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1587.57it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1587.57it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1619.97it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1619.97it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1652.37it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1652.37it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1684.77it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1631.89it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1663.27it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1663.27it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1694.66it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1694.66it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1726.04it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1726.04it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1703.91it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1703.91it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1734.34it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1708.22it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1738.19it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1738.19it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1768.16it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1768.16it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1798.12it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1798.12it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1774.62it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1774.62it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1803.71it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1803.71it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1832.81it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1832.81it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1809.33it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1809.33it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1837.60it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1837.60it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1865.87it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1865.87it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1841.95it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1841.95it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1869.44it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1869.44it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1896.93it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1896.93it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1924.42it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1873.05it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1899.81it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1899.81it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1926.57it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1926.57it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1953.33it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1953.33it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1928.49it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1928.49it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1954.55it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1954.55it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1980.61it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1980.61it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1955.69it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1955.69it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1981.09it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1981.09it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 2006.49it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 2006.49it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1981.49it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1981.49it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 2006.26it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 2006.26it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 2031.03it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 2031.03it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 2006.05it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 2006.05it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 2030.22it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 2030.22it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 2054.38it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 2054.38it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 2029.60it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 2029.60it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 2053.20it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 2053.20it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 2076.80it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 2076.80it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 2100.40it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 2052.02it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 2075.08it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 2075.08it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 2098.13it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 2098.13it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2121.19it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2073.34it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 2095.88it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 2095.88it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2118.42it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2118.42it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 2140.95it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 2140.95it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2115.79it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2115.79it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2137.83it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2137.83it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 2159.87it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 2134.88it/s, Materializing param=encoder.final_layer_norm.weight]
______________________________________ SearcherTests.test_parse_date_iso_format _______________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_parse_date_iso_format>

    def test_parse_date_iso_format(self) -> None:
        """测试ISO格式日期解析"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:81:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 999.12it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1998.24it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 1998.24it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1499.39it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1499.39it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1999.19it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1999.19it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 2498.99it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 2498.99it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 2001.58it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 2001.58it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 2335.17it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 2335.17it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 2000.98it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 2000.98it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1367.16it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1367.16it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 1319.38it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1319.38it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1451.32it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1451.32it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1397.95it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1397.95it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1357.04it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1357.04it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1323.06it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1323.06it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1352.94it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1352.94it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1222.09it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1222.09it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1206.48it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1206.48it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1277.45it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1277.45it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1258.97it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1258.97it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1325.24it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1242.98it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1305.13it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1305.13it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1287.17it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1287.17it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1271.08it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1271.08it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1257.08it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1257.08it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1309.46it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1309.46it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1294.12it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1294.12it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1294.97it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1294.97it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1281.18it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1281.18it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1268.81it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1268.81it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  30%|███       | 30/99 [00:00<00:00, 1214.40it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  30%|███       | 30/99 [00:00<00:00, 1190.19it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1201.25it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1176.77it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1214.73it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1214.73it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1206.59it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1206.59it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1199.34it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1199.34it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1192.39it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1152.66it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1185.59it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1185.59it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1179.73it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1179.73it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1174.26it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1174.26it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1205.16it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1205.16it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1199.09it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1199.09it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1229.07it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1229.07it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1259.05it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1259.05it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1251.46it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1251.46it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1280.56it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1280.56it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1309.66it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1272.58it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1300.86it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1300.86it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1329.14it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1329.14it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1320.02it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1320.02it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1347.52it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1347.52it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1375.02it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1375.02it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1364.98it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1364.98it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1391.75it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1391.75it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1418.51it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1418.51it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1407.57it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1407.57it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1433.64it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1433.64it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1459.70it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1459.70it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1485.77it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1485.77it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1473.64it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1473.64it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1499.05it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1499.05it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1524.45it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1524.45it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1549.86it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1549.86it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1536.24it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1536.24it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1561.02it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1561.02it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1585.80it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1585.80it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1571.61it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1571.61it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1595.79it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1595.79it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1619.96it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1619.96it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1605.31it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1605.31it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1628.92it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1628.92it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1652.53it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1652.53it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1676.14it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1676.14it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1660.58it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1660.58it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1683.64it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1683.64it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1706.71it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1706.71it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1690.77it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1690.77it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1713.31it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1694.10it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1716.39it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1716.39it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1738.68it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1738.68it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1760.97it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1760.97it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1744.24it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1744.24it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1766.04it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1766.04it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1787.84it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1787.84it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1771.01it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1771.01it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1792.35it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1792.35it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1813.68it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1813.68it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1835.02it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1796.68it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1817.57it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1817.57it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1838.46it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1838.46it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1859.35it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1821.32it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1841.79it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1841.79it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1862.25it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1862.25it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1882.72it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1844.96it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1865.02it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1865.02it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1885.07it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1885.07it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1905.13it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1867.65it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1887.31it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1887.31it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1906.97it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1906.97it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1926.63it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1908.74it/s, Materializing param=encoder.final_layer_norm.weight]
___________________________________ SearcherTests.test_search_without_loaded_index ____________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_search_without_loaded_index>

    def test_search_without_loaded_index(self) -> None:
        """测试未加载索引时搜索"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:137:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 1000.55it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 2001.10it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   2%|▏         | 2/99 [00:00<00:00, 2001.10it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1499.39it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1499.39it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1332.16it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1332.16it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1665.20it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1106.62it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1180.61it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1180.61it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1026.61it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1026.61it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1022.35it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 906.56it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1019.88it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1019.88it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 1017.44it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1017.44it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1015.55it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1015.55it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1014.69it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1014.69it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1099.25it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1013.61it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1091.58it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1091.58it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1085.03it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1085.03it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1079.29it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1079.29it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1146.74it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1146.74it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1137.16it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1069.22it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1065.75it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1009.32it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1062.44it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1062.44it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1059.35it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1059.35it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1109.79it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1056.38it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1104.40it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1104.40it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1099.53it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1051.12it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1049.26it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1049.26it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1091.23it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1091.23it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1087.59it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1087.59it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1084.15it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1084.15it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1122.87it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1122.87it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  30%|███       | 30/99 [00:00<00:00, 1161.59it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  30%|███       | 30/99 [00:00<00:00, 1161.59it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1200.31it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1155.66it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1192.94it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1192.94it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1230.22it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1230.22it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1221.85it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1221.85it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1257.79it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1257.79it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1293.73it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1248.92it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1283.62it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1283.62it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1318.31it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1318.31it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1353.00it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1353.00it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1341.21it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1341.21it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1374.74it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1374.74it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1408.27it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1408.27it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1441.80it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1395.01it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1427.45it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1427.45it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1459.89it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1459.89it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1492.33it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1492.33it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1476.90it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1476.90it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1508.32it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1508.32it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1539.75it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1539.75it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1571.17it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1571.17it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1553.77it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1553.77it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1584.24it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1584.24it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1614.71it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1614.71it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1596.32it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1596.32it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1625.88it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1625.88it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1655.44it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1655.44it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1636.75it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1636.75it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1665.47it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1665.47it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1694.18it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1694.18it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1674.75it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1674.75it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1702.66it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1702.66it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1730.58it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1730.58it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1710.56it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1710.56it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1737.72it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1737.72it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1764.87it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1718.32it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1744.75it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1744.75it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1771.19it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1771.19it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1797.62it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1797.62it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1776.75it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1776.75it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1802.50it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1802.50it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1828.25it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1828.25it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1807.34it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1807.34it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1832.44it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1832.44it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1857.54it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1857.54it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1836.52it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1836.52it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1861.01it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1861.01it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1885.50it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1885.50it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1864.36it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1864.36it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1888.26it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1888.26it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1912.16it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1912.16it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1936.06it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1890.54it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1913.88it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1913.88it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1937.22it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1937.22it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1960.55it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1916.17it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1938.98it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1938.98it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1961.79it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1961.79it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1984.60it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1984.60it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1962.68it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1962.68it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1984.98it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1984.98it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 2007.28it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 2007.28it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1985.30it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1985.30it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2007.12it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2007.12it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1985.63it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1985.63it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2006.98it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2006.98it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1986.01it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1986.01it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2006.91it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2006.91it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2027.82it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1986.12it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 2006.60it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1986.50it/s, Materializing param=encoder.final_layer_norm.weight]
___________________________________ SearcherTests.test_validate_query_invalid_chars ___________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_validate_query_invalid_chars>

    def test_validate_query_invalid_chars(self) -> None:
        """测试查询验证-非法字符"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:40:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   3%|▎         | 3/99 [00:00<00:00, 3368.02it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 3368.02it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1698.44it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 1698.44it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1468.18it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1468.18it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1761.82it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1761.82it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1483.21it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1340.03it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1531.47it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1531.47it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1444.21it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1444.21it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 1604.68it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1382.57it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1191.78it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1191.78it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1172.85it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1172.85it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1157.61it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1157.61it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1144.40it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1144.40it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1133.49it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1053.76it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1050.64it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1050.64it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1047.53it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1047.53it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1044.67it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 987.33it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1042.19it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1042.19it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 990.57it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  20%|██        | 20/99 [00:00<00:00, 990.57it/s, Materializing param=encoder.block.2.layer.0.SelfAttentLoading weights:  21%|██        | 21/99 [00:00<00:00, 1014.62it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1014.62it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1035.40it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1035.40it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1033.38it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1033.38it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1027.30it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1027.30it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1018.06it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1018.06it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1017.05it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1017.05it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1016.27it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1016.27it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 967.15it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 967.15it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 984.45it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 984.45it/s, Materializing param=encoder.block.3.layer.0.SelfAttentLoading weights:  30%|███       | 30/99 [00:00<00:00, 994.59it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  30%|███       | 30/99 [00:00<00:00, 994.59it/s, Materializing param=encoder.block.3.layer.0.layer_normLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1027.75it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1010.63it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1043.23it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1043.23it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1075.83it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1075.83it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1072.84it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1072.84it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1104.40it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1104.40it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1135.95it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1135.95it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1132.05it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1132.05it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1162.65it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1162.65it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1157.84it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1157.84it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1187.52it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1187.52it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1217.21it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1217.21it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1246.90it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1246.90it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1239.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1239.78it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1268.62it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1268.62it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1270.13it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1270.13it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1298.35it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1280.02it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1307.85it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1307.85it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1335.68it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1335.68it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1363.50it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1363.50it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1353.33it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1353.33it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1360.71it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1360.71it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1387.39it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1387.39it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1414.07it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1414.07it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1440.75it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1402.99it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1428.97it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1428.97it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1454.95it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1454.95it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1480.93it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1480.93it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1468.86it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1468.86it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1494.19it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1494.19it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1519.51it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1519.51it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1544.84it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1544.84it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1531.43it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1531.43it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1556.14it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1556.14it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1580.84it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1580.84it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1605.54it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1566.69it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1590.80it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1590.80it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1614.90it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1614.90it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1639.00it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1639.00it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1624.01it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1624.01it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1647.55it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1647.55it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1671.08it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1671.08it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1694.62it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1694.62it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1677.99it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1677.99it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1700.97it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1700.97it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1723.96it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1723.96it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1746.95it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1707.20it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1729.67it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1729.67it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1752.13it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1752.13it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1774.59it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1774.59it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1797.06it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1797.06it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1759.94it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1759.94it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1781.67it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1781.67it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1803.39it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1803.39it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1825.12it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1825.12it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1807.21it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1807.21it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1828.47it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1828.47it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1849.73it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1849.73it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1832.07it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1832.07it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1852.89it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1852.89it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1850.06it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1850.06it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1870.61it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1870.61it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1891.17it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1891.17it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1911.72it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1872.92it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1893.06it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1893.06it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1913.20it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1893.96it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1913.90it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1913.90it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1933.83it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1933.83it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1926.94it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1915.98it/s, Materializing param=encoder.final_layer_norm.weight]
_______________________________________ SearcherTests.test_validate_query_short _______________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_validate_query_short>

    def test_validate_query_short(self) -> None:
        """测试查询验证-过短"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:29:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<00:00, 500.27it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   2%|▏         | 2/99 [00:00<00:00, 666.93it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   2%|▏         | 2/99 [00:00<00:00, 666.93it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 750.32it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   3%|▎         | 3/99 [00:00<00:00, 750.32it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 800.29it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   4%|▍         | 4/99 [00:00<00:00, 800.29it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 833.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   5%|▌         | 5/99 [00:00<00:00, 833.43it/s, Materializing param=encoder.block.0.layer.0.SelfAttentiLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1000.11it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 857.32it/s, Materializing param=encoder.block.0.layer.0.layer_norm.Loading weights:   7%|▋         | 7/99 [00:00<00:00, 875.27it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   7%|▋         | 7/99 [00:00<00:00, 875.27it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 888.55it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   8%|▊         | 8/99 [00:00<00:00, 888.55it/s, Materializing param=encoder.block.0.layer.1.DenseReluDeLoading weights:   9%|▉         | 9/99 [00:00<00:00, 999.62it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:   9%|▉         | 9/99 [00:00<00:00, 999.62it/s, Materializing param=encoder.block.0.layer.1.layer_norm.Loading weights:  10%|█         | 10/99 [00:00<00:00, 1000.22it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1000.22it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1100.24it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1100.24it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1043.36it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 997.61it/s, Materializing param=encoder.block.1.layer.0.SelfAttentLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1080.75it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1080.75it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1074.24it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1074.24it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1108.22it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1031.42it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1029.51it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1029.51it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1027.90it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1027.90it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1088.36it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1088.36it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1083.18it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1024.76it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1078.70it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1078.70it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1074.73it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1074.73it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1045.38it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1017.13it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1063.36it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1063.36it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1060.34it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1060.34it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1057.81it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1033.99it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1075.35it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1075.35it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1116.71it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1072.16it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1111.87it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1069.45it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1107.64it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1066.91it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  30%|███       | 30/99 [00:00<00:00, 1083.37it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  30%|███       | 30/99 [00:00<00:00, 1083.37it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1119.48it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1080.18it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1115.02it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1115.02it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1149.87it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1149.87it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1184.71it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1184.71it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1178.62it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1178.62it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1212.29it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1212.29it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1245.97it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1245.97it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1279.64it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1237.97it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1270.55it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1270.55it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1303.13it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1303.13it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1335.70it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1335.70it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1325.08it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1325.08it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1356.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1356.63it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1388.18it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1388.18it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1376.32it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1376.32it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1406.91it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1406.91it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1437.49it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1437.49it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1468.08it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1424.53it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1454.21it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1454.21it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1483.89it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1483.89it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1513.57it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1476.15it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1505.10it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1505.10it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1512.00it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1512.00it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1540.52it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1540.52it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1545.65it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1545.65it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1573.75it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1573.75it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1601.86it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1601.86it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1629.96it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1629.96it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1612.57it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1612.57it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1639.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1639.91it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1667.24it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1667.24it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1694.57it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1694.57it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1676.08it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1676.08it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1702.69it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1702.69it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1729.29it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1729.29it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1755.90it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1755.90it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1736.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1736.29it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1762.20it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1762.20it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1743.00it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1743.00it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1768.26it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1768.26it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1793.52it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1793.52it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1818.78it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1818.78it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1798.61it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1798.61it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1823.25it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1823.25it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1847.88it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1847.88it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1872.52it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1872.52it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1851.51it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1851.51it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1875.56it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1875.56it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1899.61it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1899.61it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1923.65it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1923.65it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1901.96it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1901.96it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1925.44it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1902.95it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1926.15it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1926.15it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1949.36it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1949.36it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1972.57it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1972.57it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1950.32it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1950.32it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1973.00it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1973.00it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1995.68it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1995.68it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 2018.36it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 2018.36it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1995.76it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1995.76it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 2017.93it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 2017.93it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2040.11it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 2040.11it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 2062.28it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 2017.50it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2039.20it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 2039.20it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 2060.89it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 2060.89it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2082.58it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 2082.58it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2059.67it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 2059.67it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 2080.91it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 2102.14it/s, Materializing param=encoder.final_layer_norm.weight]
_______________________________________ SearcherTests.test_validate_query_valid _______________________________________

self = <tests.test_searcher.SearcherTests testMethod=test_validate_query_valid>

    def test_validate_query_valid(self) -> None:
        """测试查询验证-有效查询"""
        vector_store = VectorStore(dimension=768, index_path="test.index", metadata_path="test.json")
        searcher = Searcher(
>           embedding=T5EmbeddingService(model_name="sentence-t5-base", device="cuda"),
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            time_parser=TimeParser(api_key="test-key"),
            vector_store=vector_store,
        )

tests\test_searcher.py:51:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\embedding_service.py:153: in __init__
    self.model = SentenceTransformer(model_name, device=device)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\sentence_transformers\SentenceTransformer.py:367: in __init__
    self.to(device)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1381: in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:933: in _apply
    module._apply(fn)
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:964: in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\torch\nn\modules\module.py:1367: in convert
    return t.to(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    def _lazy_init():
        global _initialized, _queued_calls
        if is_initialized() or hasattr(_tls, "is_initializing"):
            return
        with _initialization_lock:
            # We be double-checked locking, boys!  This is OK because
            # the above test was GIL protected anyway.  The inner test
            # is for when a thread blocked on some other thread which was
            # doing the initialization; when they get the lock, they will
            # find there is nothing left to do.
            if is_initialized():
                return
            # It is important to prevent other threads from entering _lazy_init
            # immediately, while we are still guaranteed to have the GIL, because some
            # of the C calls we make below will release the GIL
            if _is_in_bad_fork():
                raise RuntimeError(
                    "Cannot re-initialize CUDA in forked subprocess. To use CUDA with "
                    "multiprocessing, you must use the 'spawn' start method"
                )
            if not hasattr(torch._C, "_cuda_getDeviceCount"):
>               raise AssertionError("Torch not compiled with CUDA enabled")
E               AssertionError: Torch not compiled with CUDA enabled

D:\software\anaconda\envs\photo\Lib\site-packages\torch\cuda\__init__.py:417: AssertionError
------------------------------------------------ Captured stderr call -------------------------------------------------
Loading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   1%|          | 1/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.k.weigLoading weights:   2%|▏         | 2/99 [00:00<?, ?it/s, Materializing param=encoder.block.0.layer.0.SelfAttention.o.weigLoading weights:   2%|▏         | 2/99 [00:00<00:00, 2003.01it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1502.08it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   3%|▎         | 3/99 [00:00<00:00, 1502.08it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 2002.77it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   4%|▍         | 4/99 [00:00<00:00, 2002.77it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1668.25it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   5%|▌         | 5/99 [00:00<00:00, 1668.25it/s, Materializing param=encoder.block.0.layer.0.SelfAttentLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1550.96it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   6%|▌         | 6/99 [00:00<00:00, 1550.96it/s, Materializing param=encoder.block.0.layer.0.layer_normLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1599.31it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   7%|▋         | 7/99 [00:00<00:00, 1599.31it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1324.74it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   8%|▊         | 8/99 [00:00<00:00, 1135.24it/s, Materializing param=encoder.block.0.layer.1.DenseReluDLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1277.15it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:   9%|▉         | 9/99 [00:00<00:00, 1277.15it/s, Materializing param=encoder.block.0.layer.1.layer_normLoading weights:  10%|█         | 10/99 [00:00<00:00, 1195.13it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  10%|█         | 10/99 [00:00<00:00, 1195.13it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1147.21it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  11%|█         | 11/99 [00:00<00:00, 1147.21it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1132.24it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  12%|█▏        | 12/99 [00:00<00:00, 1132.24it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1120.78it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  13%|█▎        | 13/99 [00:00<00:00, 1120.78it/s, Materializing param=encoder.block.1.layer.0.SelfAttenLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1206.99it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  14%|█▍        | 14/99 [00:00<00:00, 1111.12it/s, Materializing param=encoder.block.1.layer.0.layer_norLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1190.48it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  15%|█▌        | 15/99 [00:00<00:00, 1190.48it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1176.44it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  16%|█▌        | 16/99 [00:00<00:00, 1176.44it/s, Materializing param=encoder.block.1.layer.1.DenseReluLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1164.65it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  17%|█▋        | 17/99 [00:00<00:00, 1164.65it/s, Materializing param=encoder.block.1.layer.1.layer_norLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1233.16it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  18%|█▊        | 18/99 [00:00<00:00, 1233.16it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1194.65it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  19%|█▉        | 19/99 [00:00<00:00, 1194.65it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1182.49it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  20%|██        | 20/99 [00:00<00:00, 1182.49it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1241.62it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  21%|██        | 21/99 [00:00<00:00, 1241.62it/s, Materializing param=encoder.block.2.layer.0.SelfAttenLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1228.07it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  22%|██▏       | 22/99 [00:00<00:00, 1228.07it/s, Materializing param=encoder.block.2.layer.0.layer_norLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1204.66it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  23%|██▎       | 23/99 [00:00<00:00, 1204.66it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1194.02it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  24%|██▍       | 24/99 [00:00<00:00, 1194.02it/s, Materializing param=encoder.block.2.layer.1.DenseReluLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1184.82it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  25%|██▌       | 25/99 [00:00<00:00, 1184.82it/s, Materializing param=encoder.block.2.layer.1.layer_norLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1232.21it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  26%|██▋       | 26/99 [00:00<00:00, 1232.21it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1279.60it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  27%|██▋       | 27/99 [00:00<00:00, 1175.42it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1218.96it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  28%|██▊       | 28/99 [00:00<00:00, 1167.82it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1209.53it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  29%|██▉       | 29/99 [00:00<00:00, 1160.68it/s, Materializing param=encoder.block.3.layer.0.SelfAttenLoading weights:  30%|███       | 30/99 [00:00<00:00, 1176.78it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  30%|███       | 30/99 [00:00<00:00, 1176.78it/s, Materializing param=encoder.block.3.layer.0.layer_norLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1169.59it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  31%|███▏      | 31/99 [00:00<00:00, 1169.59it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1207.32it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  32%|███▏      | 32/99 [00:00<00:00, 1207.32it/s, Materializing param=encoder.block.3.layer.1.DenseReluLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1175.17it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  33%|███▎      | 33/99 [00:00<00:00, 1134.44it/s, Materializing param=encoder.block.3.layer.1.layer_norLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1168.82it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  34%|███▍      | 34/99 [00:00<00:00, 1148.86it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1162.76it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  35%|███▌      | 35/99 [00:00<00:00, 1162.76it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1157.23it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  36%|███▋      | 36/99 [00:00<00:00, 1138.70it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1151.80it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  37%|███▋      | 37/99 [00:00<00:00, 1151.80it/s, Materializing param=encoder.block.4.layer.0.SelfAttenLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1146.91it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  38%|███▊      | 38/99 [00:00<00:00, 1146.91it/s, Materializing param=encoder.block.4.layer.0.layer_norLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1142.58it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  39%|███▉      | 39/99 [00:00<00:00, 1142.58it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1171.88it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  40%|████      | 40/99 [00:00<00:00, 1171.88it/s, Materializing param=encoder.block.4.layer.1.DenseReluLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1166.97it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  41%|████▏     | 41/99 [00:00<00:00, 1134.71it/s, Materializing param=encoder.block.4.layer.1.layer_norLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1162.39it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  42%|████▏     | 42/99 [00:00<00:00, 1124.03it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1150.80it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  43%|████▎     | 43/99 [00:00<00:00, 1150.80it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1146.59it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  44%|████▍     | 44/99 [00:00<00:00, 1146.59it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1172.65it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  45%|████▌     | 45/99 [00:00<00:00, 1172.65it/s, Materializing param=encoder.block.5.layer.0.SelfAttenLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1165.85it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  46%|████▋     | 46/99 [00:00<00:00, 1165.85it/s, Materializing param=encoder.block.5.layer.0.layer_norLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1191.20it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  47%|████▋     | 47/99 [00:00<00:00, 1191.20it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1216.54it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  48%|████▊     | 48/99 [00:00<00:00, 1216.54it/s, Materializing param=encoder.block.5.layer.1.DenseReluLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1241.89it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  49%|████▉     | 49/99 [00:00<00:00, 1210.93it/s, Materializing param=encoder.block.5.layer.1.layer_norLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1235.65it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  51%|█████     | 50/99 [00:00<00:00, 1235.65it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1260.36it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  52%|█████▏    | 51/99 [00:00<00:00, 1260.36it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1285.07it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  53%|█████▎    | 52/99 [00:00<00:00, 1285.07it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1277.96it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  54%|█████▎    | 53/99 [00:00<00:00, 1277.96it/s, Materializing param=encoder.block.6.layer.0.SelfAttenLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1302.08it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  55%|█████▍    | 54/99 [00:00<00:00, 1302.08it/s, Materializing param=encoder.block.6.layer.0.layer_norLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1326.19it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  56%|█████▌    | 55/99 [00:00<00:00, 1326.19it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1318.44it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  57%|█████▋    | 56/99 [00:00<00:00, 1318.44it/s, Materializing param=encoder.block.6.layer.1.DenseReluLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1341.98it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  58%|█████▊    | 57/99 [00:00<00:00, 1341.98it/s, Materializing param=encoder.block.6.layer.1.layer_norLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1365.52it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  59%|█████▊    | 58/99 [00:00<00:00, 1365.52it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1357.04it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  60%|█████▉    | 59/99 [00:00<00:00, 1357.04it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1380.04it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  61%|██████    | 60/99 [00:00<00:00, 1380.04it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1403.04it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  62%|██████▏   | 61/99 [00:00<00:00, 1403.04it/s, Materializing param=encoder.block.7.layer.0.SelfAttenLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1394.08it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  63%|██████▎   | 62/99 [00:00<00:00, 1394.08it/s, Materializing param=encoder.block.7.layer.0.layer_norLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1416.57it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  64%|██████▎   | 63/99 [00:00<00:00, 1416.57it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1439.05it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  65%|██████▍   | 64/99 [00:00<00:00, 1439.05it/s, Materializing param=encoder.block.7.layer.1.DenseReluLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1461.54it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  66%|██████▌   | 65/99 [00:00<00:00, 1429.48it/s, Materializing param=encoder.block.7.layer.1.layer_norLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1451.47it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  67%|██████▋   | 66/99 [00:00<00:00, 1451.47it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1473.46it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  68%|██████▊   | 67/99 [00:00<00:00, 1473.46it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1495.45it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  69%|██████▊   | 68/99 [00:00<00:00, 1495.45it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1484.76it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  70%|██████▉   | 69/99 [00:00<00:00, 1484.76it/s, Materializing param=encoder.block.8.layer.0.SelfAttenLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1506.27it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  71%|███████   | 70/99 [00:00<00:00, 1506.27it/s, Materializing param=encoder.block.8.layer.0.layer_norLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1495.55it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  72%|███████▏  | 71/99 [00:00<00:00, 1495.55it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1516.61it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  73%|███████▎  | 72/99 [00:00<00:00, 1516.61it/s, Materializing param=encoder.block.8.layer.1.DenseReluLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1537.68it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  74%|███████▎  | 73/99 [00:00<00:00, 1537.68it/s, Materializing param=encoder.block.8.layer.1.layer_norLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1558.74it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  75%|███████▍  | 74/99 [00:00<00:00, 1526.63it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1547.26it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  76%|███████▌  | 75/99 [00:00<00:00, 1547.26it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1567.89it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  77%|███████▋  | 76/99 [00:00<00:00, 1567.89it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1588.52it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  78%|███████▊  | 77/99 [00:00<00:00, 1588.52it/s, Materializing param=encoder.block.9.layer.0.SelfAttenLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1576.57it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  79%|███████▉  | 78/99 [00:00<00:00, 1576.57it/s, Materializing param=encoder.block.9.layer.0.layer_norLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1596.78it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  80%|███████▉  | 79/99 [00:00<00:00, 1596.78it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1617.00it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  81%|████████  | 80/99 [00:00<00:00, 1617.00it/s, Materializing param=encoder.block.9.layer.1.DenseReluLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1604.72it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  82%|████████▏ | 81/99 [00:00<00:00, 1604.72it/s, Materializing param=encoder.block.9.layer.1.layer_norLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1624.53it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  83%|████████▎ | 82/99 [00:00<00:00, 1624.53it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1644.34it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  84%|████████▍ | 83/99 [00:00<00:00, 1644.34it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1664.15it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  85%|████████▍ | 84/99 [00:00<00:00, 1631.93it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1651.35it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  86%|████████▌ | 85/99 [00:00<00:00, 1651.35it/s, Materializing param=encoder.block.10.layer.0.SelfAtteLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1670.78it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  87%|████████▋ | 86/99 [00:00<00:00, 1670.78it/s, Materializing param=encoder.block.10.layer.0.layer_noLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1690.21it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  88%|████████▊ | 87/99 [00:00<00:00, 1690.21it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1665.76it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  89%|████████▉ | 88/99 [00:00<00:00, 1665.76it/s, Materializing param=encoder.block.10.layer.1.DenseRelLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1684.69it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  90%|████████▉ | 89/99 [00:00<00:00, 1684.69it/s, Materializing param=encoder.block.10.layer.1.layer_noLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1703.62it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  91%|█████████ | 90/99 [00:00<00:00, 1703.62it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1722.55it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  92%|█████████▏| 91/99 [00:00<00:00, 1684.91it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1703.42it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  93%|█████████▎| 92/99 [00:00<00:00, 1703.42it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1721.94it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  94%|█████████▍| 93/99 [00:00<00:00, 1721.94it/s, Materializing param=encoder.block.11.layer.0.SelfAtteLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1740.45it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  95%|█████████▍| 94/99 [00:00<00:00, 1740.45it/s, Materializing param=encoder.block.11.layer.0.layer_noLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1758.97it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  96%|█████████▌| 95/99 [00:00<00:00, 1758.97it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1777.48it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  97%|█████████▋| 96/99 [00:00<00:00, 1725.36it/s, Materializing param=encoder.block.11.layer.1.DenseRelLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1743.33it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  98%|█████████▊| 97/99 [00:00<00:00, 1743.33it/s, Materializing param=encoder.block.11.layer.1.layer_noLoading weights:  99%|█████████▉| 98/99 [00:00<00:00, 1761.30it/s, Materializing param=encoder.embed_tokens.weight]     Loading weights: 100%|██████████| 99/99 [00:00<00:00, 1755.79it/s, Materializing param=encoder.final_layer_norm.weight]
______________________________________ VectorStoreTests.test_add_and_search_item ______________________________________

self = <tests.test_vector_store.VectorStoreTests testMethod=test_add_and_search_item>

    def test_add_and_search_item(self) -> None:
        """测试添加和搜索向量"""
        with tempfile.TemporaryDirectory() as tmp:
            index_path = os.path.join(tmp, "index.bin")
            metadata_path = os.path.join(tmp, "metadata.json")
            store = VectorStore(dimension=self.dimension, index_path=index_path, metadata_path=metadata_path)

            vec1 = [0.1] * self.dimension
            vec2 = [0.5] * self.dimension
            store.add_item(vec1, {"id": 1, "photo": "test1.jpg"})
            store.add_item(vec2, {"id": 2, "photo": "test2.jpg"})

            results = store.search(vec1, top_k=1)
            self.assertEqual(len(results), 1)
            self.assertEqual(results[0]["metadata"]["id"], 1)
>           self.assertGreater(results[0]["metadata"], 0.0)
E           TypeError: '>' not supported between instances of 'dict' and 'float'

tests\test_vector_store.py:50: TypeError
_______________________ VisionServiceTests.test_openrouter_vision_service_generate_description ________________________

self = <utils.vision_llm_service.OpenRouterVisionLLMService object at 0x0000016E812F5210>
image_path = 'C:\\Users\\86159\\AppData\\Local\\Temp\\tmpkl5jr249\\test.jpg'

    def generate_description(self, image_path: str) -> str:
        """
        生成图片描述（中文）。

        Args:
            image_path (str): 图片路径

        Returns:
            str: 描述文本
        """
        prompt = (
            "请用中文描述这张图片，包含以下要素：\n"
            "1. 场景描述（室内/室外，具体地点）\n"
            "2. 主要主体（人物、物体、动物等）\n"
            "3. 动作或状态（在做什么）\n"
            "4. 环境细节（光线、天气、背景）\n"
            "5. 情绪氛围（欢乐、温馨、宁静等）\n\n"
            "描述长度：50-200字"
        )
        image_url = self._get_image_url(image_path)
        messages = [
            {
                "role": "user",
                "content": [
                    {"type": "text", "text": prompt},
                    {"type": "image_url", "image_url": {"url": image_url}},
                ],
            }
        ]

        for attempt in range(self.max_retries):
            try:
>               response = self.client.chat.completions.create(
                    model=self.model_name,
                    messages=messages,
                    temperature=0.2,
                    timeout=self.timeout,
                )

utils\vision_llm_service.py:128:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\software\anaconda\envs\photo\Lib\site-packages\openai\_utils\_utils.py:286: in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\openai\resources\chat\completions\completions.py:1192: in create
    return self._post(
D:\software\anaconda\envs\photo\Lib\site-packages\openai\_base_client.py:1294: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <openai.OpenAI object at 0x0000016E812F4290>
cast_to = <class 'openai.types.chat.chat_completion.ChatCompletion'>
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...CAppData%5CLocal%5CTemp%5Ctmpkl5jr249%5Ctest.jpg'}}]}], 'model': 'openai/gpt-4o', 'temperature': 0.2}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -> ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)

        # create a copy of the options we were given so that if the
        # options are mutated later & we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()

        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)

        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)

            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)

            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth

            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects

            log.debug("Sending HTTP Request: %s %s", request.method, request.url)

            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)

                if remaining_retries > 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue

                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)

                if remaining_retries > 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue

                log.debug("Raising connection error")
                raise APIConnectionError(request=request) from err

            log.debug(
                'HTTP Response: %s %s "%i %s" %s',
                request.method,
                request.url,
                response.status_code,
                response.reason_phrase,
                response.headers,
            )
            log.debug("request_id: %s", response.headers.get("x-request-id"))

            try:
                response.raise_for_status()
            except httpx.HTTPStatusError as err:  # thrown on 4xx and 5xx status code
                log.debug("Encountered httpx.HTTPStatusError", exc_info=True)

                if remaining_retries > 0 and self._should_retry(err.response):
                    err.response.close()
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=response,
                    )
                    continue

                # If the response is streamed then we need to explicitly read the response
                # to completion before attempting to access the response text.
                if not err.response.is_closed:
                    err.response.read()

                log.debug("Re-raising status error")
>               raise self._make_status_error_from_response(err.response) from None
E               openai.BadRequestError: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata': {'raw': '{"error":{"code":"BadRequest","message":"The provided image url is not accessible.","param":null,"type":null}}', 'provider_name': 'Azure', 'is_byok': False}}, 'user_id': 'user_30twuG2y5I55gCwfq74EVMLScN9'}

D:\software\anaconda\envs\photo\Lib\site-packages\openai\_base_client.py:1067: BadRequestError

The above exception was the direct cause of the following exception:

self = <tests.test_vision_llm_service.VisionServiceTests testMethod=test_openrouter_vision_service_generate_description>

    @unittest.skipIf(
        not bool(os.getenv("OPENROUTER_API_KEY")),
        "OPENROUTER_API_KEY未设置，跳过集成测试"
    )
    def test_openrouter_vision_service_generate_description(self) -> None:
        """测试OpenRouter Vision服务生成描述（集成测试）"""
        with tempfile.TemporaryDirectory() as tmp:
            path = os.path.join(tmp, "test.jpg")
            image = Image.new("RGB", (200, 150), color=(255, 128, 64))
            image.save(path)

            api_key = self.config["OPENROUTER_API_KEY"]
            base_url = self.config.get("OPENROUTER_BASE_URL", "https://openrouter.ai/api/v1")

            service = OpenRouterVisionLLMService(
                api_key=api_key,
                base_url=base_url,
                server_host="localhost",
                server_port=5000,
                max_retries=2,
            )

>           result = service.generate_description(path)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

tests\test_vision_llm_service.py:101:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <utils.vision_llm_service.OpenRouterVisionLLMService object at 0x0000016E812F5210>
image_path = 'C:\\Users\\86159\\AppData\\Local\\Temp\\tmpkl5jr249\\test.jpg'

    def generate_description(self, image_path: str) -> str:
        """
        生成图片描述（中文）。

        Args:
            image_path (str): 图片路径

        Returns:
            str: 描述文本
        """
        prompt = (
            "请用中文描述这张图片，包含以下要素：\n"
            "1. 场景描述（室内/室外，具体地点）\n"
            "2. 主要主体（人物、物体、动物等）\n"
            "3. 动作或状态（在做什么）\n"
            "4. 环境细节（光线、天气、背景）\n"
            "5. 情绪氛围（欢乐、温馨、宁静等）\n\n"
            "描述长度：50-200字"
        )
        image_url = self._get_image_url(image_path)
        messages = [
            {
                "role": "user",
                "content": [
                    {"type": "text", "text": prompt},
                    {"type": "image_url", "image_url": {"url": image_url}},
                ],
            }
        ]

        for attempt in range(self.max_retries):
            try:
                response = self.client.chat.completions.create(
                    model=self.model_name,
                    messages=messages,
                    temperature=0.2,
                    timeout=self.timeout,
                )
                content = response.choices[0].message.content.strip()
                if not content:
                    raise ValueError("Vision LLM返回空描述")
                return content
            except Exception as exc:
                if attempt == self.max_retries - 1:
>                   raise ValueError(f"生成描述失败: {exc}") from exc  # 捕获API调用失败，避免中断整体流程
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E                   ValueError: 生成描述失败: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata': {'raw': '{"error":{"code":"BadRequest","message":"The provided image url is not accessible.","param":null,"type":null}}', 'provider_name': 'Azure', 'is_byok': False}}, 'user_id': 'user_30twuG2y5I55gCwfq74EVMLScN9'}

utils\vision_llm_service.py:140: ValueError
____________________ VisionServiceTests.test_openrouter_vision_service_generate_description_batch _____________________

self = <utils.vision_llm_service.OpenRouterVisionLLMService object at 0x0000016E7B68C710>
image_path = 'C:\\Users\\86159\\AppData\\Local\\Temp\\tmp4r5679_u\\test0.jpg'

    def generate_description(self, image_path: str) -> str:
        """
        生成图片描述（中文）。

        Args:
            image_path (str): 图片路径

        Returns:
            str: 描述文本
        """
        prompt = (
            "请用中文描述这张图片，包含以下要素：\n"
            "1. 场景描述（室内/室外，具体地点）\n"
            "2. 主要主体（人物、物体、动物等）\n"
            "3. 动作或状态（在做什么）\n"
            "4. 环境细节（光线、天气、背景）\n"
            "5. 情绪氛围（欢乐、温馨、宁静等）\n\n"
            "描述长度：50-200字"
        )
        image_url = self._get_image_url(image_path)
        messages = [
            {
                "role": "user",
                "content": [
                    {"type": "text", "text": prompt},
                    {"type": "image_url", "image_url": {"url": image_url}},
                ],
            }
        ]

        for attempt in range(self.max_retries):
            try:
>               response = self.client.chat.completions.create(
                    model=self.model_name,
                    messages=messages,
                    temperature=0.2,
                    timeout=self.timeout,
                )

utils\vision_llm_service.py:128:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\software\anaconda\envs\photo\Lib\site-packages\openai\_utils\_utils.py:286: in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
D:\software\anaconda\envs\photo\Lib\site-packages\openai\resources\chat\completions\completions.py:1192: in create
    return self._post(
D:\software\anaconda\envs\photo\Lib\site-packages\openai\_base_client.py:1294: in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <openai.OpenAI object at 0x0000016E7D084FD0>
cast_to = <class 'openai.types.chat.chat_completion.ChatCompletion'>
options = FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeo...AppData%5CLocal%5CTemp%5Ctmp4r5679_u%5Ctest0.jpg'}}]}], 'model': 'openai/gpt-4o', 'temperature': 0.2}, extra_json=None)

    def request(
        self,
        cast_to: Type[ResponseT],
        options: FinalRequestOptions,
        *,
        stream: bool = False,
        stream_cls: type[_StreamT] | None = None,
    ) -> ResponseT | _StreamT:
        cast_to = self._maybe_override_cast_to(cast_to, options)

        # create a copy of the options we were given so that if the
        # options are mutated later & we then retry, the retries are
        # given the original options
        input_options = model_copy(options)
        if input_options.idempotency_key is None and input_options.method.lower() != "get":
            # ensure the idempotency key is reused between requests
            input_options.idempotency_key = self._idempotency_key()

        response: httpx.Response | None = None
        max_retries = input_options.get_max_retries(self.max_retries)

        retries_taken = 0
        for retries_taken in range(max_retries + 1):
            options = model_copy(input_options)
            options = self._prepare_options(options)

            remaining_retries = max_retries - retries_taken
            request = self._build_request(options, retries_taken=retries_taken)
            self._prepare_request(request)

            kwargs: HttpxSendArgs = {}
            if self.custom_auth is not None:
                kwargs["auth"] = self.custom_auth

            if options.follow_redirects is not None:
                kwargs["follow_redirects"] = options.follow_redirects

            log.debug("Sending HTTP Request: %s %s", request.method, request.url)

            response = None
            try:
                response = self._client.send(
                    request,
                    stream=stream or self._should_stream_response_body(request=request),
                    **kwargs,
                )
            except httpx.TimeoutException as err:
                log.debug("Encountered httpx.TimeoutException", exc_info=True)

                if remaining_retries > 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue

                log.debug("Raising timeout error")
                raise APITimeoutError(request=request) from err
            except Exception as err:
                log.debug("Encountered Exception", exc_info=True)

                if remaining_retries > 0:
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=None,
                    )
                    continue

                log.debug("Raising connection error")
                raise APIConnectionError(request=request) from err

            log.debug(
                'HTTP Response: %s %s "%i %s" %s',
                request.method,
                request.url,
                response.status_code,
                response.reason_phrase,
                response.headers,
            )
            log.debug("request_id: %s", response.headers.get("x-request-id"))

            try:
                response.raise_for_status()
            except httpx.HTTPStatusError as err:  # thrown on 4xx and 5xx status code
                log.debug("Encountered httpx.HTTPStatusError", exc_info=True)

                if remaining_retries > 0 and self._should_retry(err.response):
                    err.response.close()
                    self._sleep_for_retry(
                        retries_taken=retries_taken,
                        max_retries=max_retries,
                        options=input_options,
                        response=response,
                    )
                    continue

                # If the response is streamed then we need to explicitly read the response
                # to completion before attempting to access the response text.
                if not err.response.is_closed:
                    err.response.read()

                log.debug("Re-raising status error")
>               raise self._make_status_error_from_response(err.response) from None
E               openai.BadRequestError: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata': {'raw': '{"error":{"code":"BadRequest","message":"The provided image url is not accessible.","param":null,"type":null}}', 'provider_name': 'Azure', 'is_byok': False}}, 'user_id': 'user_30twuG2y5I55gCwfq74EVMLScN9'}

D:\software\anaconda\envs\photo\Lib\site-packages\openai\_base_client.py:1067: BadRequestError

The above exception was the direct cause of the following exception:

self = <tests.test_vision_llm_service.VisionServiceTests testMethod=test_openrouter_vision_service_generate_description_batch>

    @unittest.skipIf(
        not bool(os.getenv("OPENROUTER_API_KEY")),
        "OPENROUTER_API_KEY未设置，跳过集成测试"
    )
    def test_openrouter_vision_service_generate_description_batch(self) -> None:
        """测试批量生成描述（集成测试）"""
        with tempfile.TemporaryDirectory() as tmp:
            paths = []
            for i in range(3):
                path = os.path.join(tmp, f"test{i}.jpg")
                image = Image.new("RGB", (100, 100), color=(i * 50, i * 50, i * 50))
                image.save(path)
                paths.append(path)

            api_key = self.config["OPENROUTER_API_KEY"]
            base_url = self.config.get("OPENROUTER_BASE_URL", "https://openrouter.ai/api/v1")

            service = OpenRouterVisionLLMService(
                api_key=api_key,
                base_url=base_url,
                server_host="localhost",
                server_port=5000,
                max_retries=2,
            )

>           results = service.generate_description_batch(paths)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

tests\test_vision_llm_service.py:132:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
utils\vision_llm_service.py:157: in generate_description_batch
    descriptions.append(self.generate_description(image_path))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <utils.vision_llm_service.OpenRouterVisionLLMService object at 0x0000016E7B68C710>
image_path = 'C:\\Users\\86159\\AppData\\Local\\Temp\\tmp4r5679_u\\test0.jpg'

    def generate_description(self, image_path: str) -> str:
        """
        生成图片描述（中文）。

        Args:
            image_path (str): 图片路径

        Returns:
            str: 描述文本
        """
        prompt = (
            "请用中文描述这张图片，包含以下要素：\n"
            "1. 场景描述（室内/室外，具体地点）\n"
            "2. 主要主体（人物、物体、动物等）\n"
            "3. 动作或状态（在做什么）\n"
            "4. 环境细节（光线、天气、背景）\n"
            "5. 情绪氛围（欢乐、温馨、宁静等）\n\n"
            "描述长度：50-200字"
        )
        image_url = self._get_image_url(image_path)
        messages = [
            {
                "role": "user",
                "content": [
                    {"type": "text", "text": prompt},
                    {"type": "image_url", "image_url": {"url": image_url}},
                ],
            }
        ]

        for attempt in range(self.max_retries):
            try:
                response = self.client.chat.completions.create(
                    model=self.model_name,
                    messages=messages,
                    temperature=0.2,
                    timeout=self.timeout,
                )
                content = response.choices[0].message.content.strip()
                if not content:
                    raise ValueError("Vision LLM返回空描述")
                return content
            except Exception as exc:
                if attempt == self.max_retries - 1:
>                   raise ValueError(f"生成描述失败: {exc}") from exc  # 捕获API调用失败，避免中断整体流程
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E                   ValueError: 生成描述失败: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata': {'raw': '{"error":{"code":"BadRequest","message":"The provided image url is not accessible.","param":null,"type":null}}', 'provider_name': 'Azure', 'is_byok': False}}, 'user_id': 'user_30twuG2y5I55gCwfq74EVMLScN9'}

utils\vision_llm_service.py:140: ValueError
================================================== warnings summary ===================================================
<frozen importlib._bootstrap>:241
  <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

<frozen importlib._bootstrap>:241
  <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

<frozen importlib._bootstrap>:241
  <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type swigvarlink has no __module__ attribute

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=============================================== short test summary info ===============================================
FAILED tests/test_embedding_service.py::EmbeddingServiceTests::test_embedding_vector_dimension_consistency - AssertionError: False is not true
FAILED tests/test_embedding_service.py::EmbeddingServiceTests::test_t5_embedding_service_init - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_build_index_fails_when_no_photos - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_compute_fallback_ratio - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_generate_description_with_local_service - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_get_status_initial - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_scan_photos_empty_directory - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_indexer.py::IndexerTests::test_scan_photos_filters_and_sorts - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_distance_to_score - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_get_index_stats_not_loaded - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_parse_date_datetime_format - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_parse_date_invalid - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_parse_date_iso_format - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_search_without_loaded_index - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_validate_query_invalid_chars - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_validate_query_short - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_searcher.py::SearcherTests::test_validate_query_valid - AssertionError: Torch not compiled with CUDA enabled
FAILED tests/test_vector_store.py::VectorStoreTests::test_add_and_search_item - TypeError: '>' not supported between instances of 'dict' and 'float'
FAILED tests/test_vision_llm_service.py::VisionServiceTests::test_openrouter_vision_service_generate_description - ValueError: 生成描述失败: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata...
FAILED tests/test_vision_llm_service.py::VisionServiceTests::test_openrouter_vision_service_generate_description_batch - ValueError: 生成描述失败: Error code: 400 - {'error': {'message': 'Provider returned error', 'code': 400, 'metadata...
================================ 20 failed, 30 passed, 3 warnings in 538.53s (0:08:58) ================================

测试失败，退出码：1